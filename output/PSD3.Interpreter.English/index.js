// Generated by purs version 0.15.15
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Control_Monad_Writer from "../Control.Monad.Writer/index.js";
import * as Control_Monad_Writer_Class from "../Control.Monad.Writer.Class/index.js";
import * as Control_Monad_Writer_Trans from "../Control.Monad.Writer.Trans/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Identity from "../Data.Identity/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Monoid from "../Data.Monoid/index.js";
import * as Data_Semigroup from "../Data.Semigroup/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Tuple from "../Data.Tuple/index.js";
import * as PSD3_AST from "../PSD3.AST/index.js";
import * as PSD3_Internal_Attribute from "../PSD3.Internal.Attribute/index.js";
import * as PSD3_Internal_Selection_Types from "../PSD3.Internal.Selection.Types/index.js";
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var show1 = /* #__PURE__ */ Data_Show.show(Data_Show.showBoolean);
var discard = /* #__PURE__ */ Control_Bind.discard(Control_Bind.discardUnit)(/* #__PURE__ */ Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupString)(Data_Identity.bindIdentity));
var tell = /* #__PURE__ */ Control_Monad_Writer_Class.tell(/* #__PURE__ */ Control_Monad_Writer_Trans.monadTellWriterT(Data_Monoid.monoidString)(Data_Identity.monadIdentity));
var applicativeWriterT = /* #__PURE__ */ Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidString)(Data_Identity.applicativeIdentity);
var when = /* #__PURE__ */ Control_Applicative.when(applicativeWriterT);
var for_ = /* #__PURE__ */ Data_Foldable.for_(applicativeWriterT)(Data_Foldable.foldableArray);
var show2 = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var showElemType = function (v) {
    if (v instanceof PSD3_Internal_Selection_Types.SVG) {
        return "SVG container";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Group) {
        return "group";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Circle) {
        return "circle";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Rect) {
        return "rectangle";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Path) {
        return "path";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Line) {
        return "line";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Text) {
        return "text";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Div) {
        return "div";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Span) {
        return "span";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Table) {
        return "table";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Tbody) {
        return "table body";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Thead) {
        return "table head";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Tr) {
        return "table row";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Td) {
        return "table cell";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Th) {
        return "table header";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Defs) {
        return "definitions";
    };
    if (v instanceof PSD3_Internal_Selection_Types.LinearGradient) {
        return "linear gradient";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Stop) {
        return "gradient stop";
    };
    if (v instanceof PSD3_Internal_Selection_Types.PatternFill) {
        return "fill pattern";
    };
    throw new Error("Failed pattern match at PSD3.Interpreter.English (line 118, column 1 - line 118, column 38): " + [ v.constructor.name ]);
};
var showAttrValue = function (v) {
    if (v instanceof PSD3_Internal_Attribute.StringValue) {
        return "\"" + (v.value0 + "\"");
    };
    if (v instanceof PSD3_Internal_Attribute.NumberValue) {
        return show(v.value0);
    };
    if (v instanceof PSD3_Internal_Attribute.BooleanValue) {
        return show1(v.value0);
    };
    throw new Error("Failed pattern match at PSD3.Interpreter.English (line 144, column 1 - line 144, column 42): " + [ v.constructor.name ]);
};
var showAttrName = function (v) {
    return v;
};
var indent = function (v) {
    if (v === 0) {
        return "";
    };
    return "  " + indent(v - 1 | 0);
};
var describeSource = function (v) {
    if (v instanceof PSD3_Internal_Attribute.UnknownSource) {
        return "based on data (dynamic)";
    };
    if (v instanceof PSD3_Internal_Attribute.StaticSource) {
        return "to " + v.value0;
    };
    if (v instanceof PSD3_Internal_Attribute.FieldSource) {
        return "from data field '" + (v.value0 + "'");
    };
    if (v instanceof PSD3_Internal_Attribute.ExprSource) {
        return "computed as " + v.value0;
    };
    if (v instanceof PSD3_Internal_Attribute.IndexSource) {
        return "from element index";
    };
    if (v instanceof PSD3_Internal_Attribute.OpaqueSource) {
        return "using external metadata (opaque)";
    };
    throw new Error("Failed pattern match at PSD3.Interpreter.English (line 109, column 18 - line 115, column 53): " + [ v.constructor.name ]);
};
var describeAttribute = function (v) {
    if (v instanceof PSD3_Internal_Attribute.StaticAttr) {
        return "Set " + (showAttrName(v.value0) + (" to " + showAttrValue(v.value1)));
    };
    if (v instanceof PSD3_Internal_Attribute.DataAttr) {
        return "Set " + (showAttrName(v.value0) + (" " + describeSource(v.value1)));
    };
    if (v instanceof PSD3_Internal_Attribute.IndexedAttr) {
        return "Set " + (showAttrName(v.value0) + (" " + describeSource(v.value1)));
    };
    throw new Error("Failed pattern match at PSD3.Interpreter.English (line 97, column 1 - line 97, column 61): " + [ v.constructor.name ]);
};
var describeTree = function (tree) {
    return function (level) {
        if (tree instanceof PSD3_AST.Node) {
            return discard((function () {
                if (tree.value0.name instanceof Data_Maybe.Just) {
                    return tell(indent(level) + ("Create a " + (showElemType(tree.value0.elemType) + (" named \"" + (tree.value0.name.value0 + "\"")))));
                };
                if (tree.value0.name instanceof Data_Maybe.Nothing) {
                    return tell(indent(level) + ("Create a " + showElemType(tree.value0.elemType)));
                };
                throw new Error("Failed pattern match at PSD3.Interpreter.English (line 33, column 5 - line 35, column 77): " + [ tree.value0.name.constructor.name ]);
            })())(function () {
                return discard(when(!Data_Array["null"](tree.value0.attrs))(discard(tell(" with attributes:\x0a"))(function () {
                    return for_(tree.value0.attrs)(function (attr) {
                        return tell(indent(level + 1 | 0) + (describeAttribute(attr) + "\x0a"));
                    });
                })))(function () {
                    return when(!Data_Array["null"](tree.value0.children))(discard(tell(indent(level) + ("Then add " + (show2(Data_Array.length(tree.value0.children)) + " child element(s):\x0a"))))(function () {
                        return for_(tree.value0.children)(function (child) {
                            return describeTree(child)(level + 1 | 0);
                        });
                    }));
                });
            });
        };
        if (tree instanceof PSD3_AST.Join) {
            return discard(tell(indent(level) + ("For each of " + (show2(Data_Array.length(tree.value0.joinData)) + " data items, "))))(function () {
                return discard(tell("create a " + (tree.value0.key + (" (join named \"" + (tree.value0.name + "\")")))))(function () {
                    return discard(tell(" using data-driven attributes\x0a"))(function () {
                        return tell(indent(level + 1 | 0) + "(Template function defined for creating elements from data)\x0a");
                    });
                });
            });
        };
        if (tree instanceof PSD3_AST.NestedJoin) {
            return discard(tell(indent(level) + ("For each of " + (show2(Data_Array.length(tree.value0.joinData)) + " nested data items, "))))(function () {
                return discard(tell("create a " + (tree.value0.key + (" (nested join named \"" + (tree.value0.name + "\")")))))(function () {
                    return discard(tell(" using data-driven attributes\x0a"))(function () {
                        return tell(indent(level + 1 | 0) + "(Nested template function defined)\x0a");
                    });
                });
            });
        };
        if (tree instanceof PSD3_AST.UpdateJoin) {
            return discard(tell(indent(level) + ("For each of " + (show2(Data_Array.length(tree.value0.joinData)) + " data items, "))))(function () {
                return discard(tell("create/update/remove " + (tree.value0.key + (" (update join named \"" + (tree.value0.name + "\")")))))(function () {
                    return discard(tell(" with General Update Pattern:\x0a"))(function () {
                        return discard(when(Data_Maybe.isJust(tree.value0.behaviors.enter))(tell(indent(level + 1 | 0) + "- Enter: elements appear with initial attributes and transition\x0a")))(function () {
                            return discard(when(Data_Maybe.isJust(tree.value0.behaviors.update))(tell(indent(level + 1 | 0) + "- Update: elements transition to new state\x0a")))(function () {
                                return discard(when(Data_Maybe.isJust(tree.value0.behaviors.exit))(tell(indent(level + 1 | 0) + "- Exit: elements transition out then removed\x0a")))(function () {
                                    return tell(indent(level + 1 | 0) + "(Template function defined for creating elements from data)\x0a");
                                });
                            });
                        });
                    });
                });
            });
        };
        if (tree instanceof PSD3_AST.UpdateNestedJoin) {
            return discard(tell(indent(level) + ("For each of " + (show2(Data_Array.length(tree.value0.joinData)) + " nested data items, "))))(function () {
                return discard(tell("decompose and create/update/remove " + (tree.value0.key + (" (update nested join named \"" + (tree.value0.name + "\")")))))(function () {
                    return discard(tell(" with General Update Pattern:\x0a"))(function () {
                        return discard(when(Data_Maybe.isJust(tree.value0.behaviors.enter))(tell(indent(level + 1 | 0) + "- Enter: elements appear with initial attributes and transition\x0a")))(function () {
                            return discard(when(Data_Maybe.isJust(tree.value0.behaviors.update))(tell(indent(level + 1 | 0) + "- Update: elements transition to new state\x0a")))(function () {
                                return discard(when(Data_Maybe.isJust(tree.value0.behaviors.exit))(tell(indent(level + 1 | 0) + "- Exit: elements transition out then removed\x0a")))(function () {
                                    return tell(indent(level + 1 | 0) + "(Decompose and template functions defined)\x0a");
                                });
                            });
                        });
                    });
                });
            });
        };
        if (tree instanceof PSD3_AST.ConditionalRender) {
            return discard(tell(indent(level) + ("Conditionally render one of " + (show2(Data_Array.length(tree.value0.cases)) + " different specs "))))(function () {
                return discard(tell("based on data predicates (chimeric visualization):\x0a"))(function () {
                    return tell(indent(level + 1 | 0) + "(Predicates and specs defined as functions)\x0a");
                });
            });
        };
        if (tree instanceof PSD3_AST.LocalCoordSpace) {
            return discard(tell(indent(level) + "Create local coordinate space for embedded visualization:\x0a"))(function () {
                return discard(tell(indent(level + 1 | 0) + "(Scale functions defined for width/height)\x0a"))(function () {
                    return describeTree(tree.value0.child)(level + 1 | 0);
                });
            });
        };
        throw new Error("Failed pattern match at PSD3.Interpreter.English (line 31, column 27 - line 94, column 35): " + [ tree.constructor.name ]);
    };
};
var runEnglish = function (tree) {
    return Data_Tuple.snd(Control_Monad_Writer.runWriter(describeTree(tree)(0)));
};
export {
    runEnglish,
    describeTree,
    describeAttribute,
    showElemType,
    showAttrName,
    showAttrValue,
    indent
};
//# sourceMappingURL=index.js.map
