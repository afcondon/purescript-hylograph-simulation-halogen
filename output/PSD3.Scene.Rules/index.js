// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Function from "../Data.Function/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Nullable from "../Data.Nullable/index.js";
import * as PSD3_Scene_Types from "../PSD3.Scene.Types/index.js";
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var unpin = function (n) {
    var $6 = {};
    for (var $7 in n) {
        if ({}.hasOwnProperty.call(n, $7)) {
            $6[$7] = n[$7];
        };
    };
    $6.fx = Data_Nullable["null"];
    $6.fy = Data_Nullable["null"];
    return $6;
};
var setPosition = function (targetX) {
    return function (targetY) {
        return function (n) {
            var $9 = {};
            for (var $10 in n) {
                if ({}.hasOwnProperty.call(n, $10)) {
                    $9[$10] = n[$10];
                };
            };
            $9.x = targetX;
            $9.y = targetY;
            return $9;
        };
    };
};
var ruleAll = function (name) {
    return function (apply) {
        return {
            name: name,
            select: Data_Function["const"](true),
            apply: apply
        };
    };
};
var rule = function (name) {
    return function (select) {
        return function (apply) {
            return {
                name: name,
                select: select,
                apply: apply
            };
        };
    };
};
var pinAtCurrent = function (n) {
    var $12 = {};
    for (var $13 in n) {
        if ({}.hasOwnProperty.call(n, $13)) {
            $12[$13] = n[$13];
        };
    };
    $12.fx = Data_Nullable.notNull(n.x);
    $12.fy = Data_Nullable.notNull(n.y);
    return $12;
};
var pinAt = function (targetX) {
    return function (targetY) {
        return function (n) {
            var $15 = {};
            for (var $16 in n) {
                if ({}.hasOwnProperty.call(n, $16)) {
                    $15[$16] = n[$16];
                };
            };
            $15.x = targetX;
            $15.y = targetY;
            $15.fx = Data_Nullable.notNull(targetX);
            $15.fy = Data_Nullable.notNull(targetY);
            return $15;
        };
    };
};
var applyFirstMatch = function (rules) {
    return function (node) {
        var v = Data_Array.find(function (r) {
            return r.select(node);
        })(rules);
        if (v instanceof Data_Maybe.Just) {
            return v.value0.apply(node);
        };
        if (v instanceof Data_Maybe.Nothing) {
            return node;
        };
        throw new Error("Failed pattern match at PSD3.Scene.Rules (line 159, column 3 - line 161, column 20): " + [ v.constructor.name ]);
    };
};
var applyRules = function (rules) {
    return function (nodes) {
        return map(applyFirstMatch(rules))(nodes);
    };
};
export {
    rule,
    ruleAll,
    pinAtCurrent,
    pinAt,
    unpin,
    setPosition,
    applyRules,
    applyFirstMatch
};
//# sourceMappingURL=index.js.map
