// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Monoid from "../Data.Monoid/index.js";
import * as Data_Newtype from "../Data.Newtype/index.js";
import * as Data_Semigroup from "../Data.Semigroup/index.js";
import * as Data_Show from "../Data.Show/index.js";
var over = /* #__PURE__ */ Data_Newtype.over()();
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var elem = /* #__PURE__ */ Data_Array.elem(Data_Eq.eqString);
var append1 = /* #__PURE__ */ Data_Semigroup.append(Data_Semigroup.semigroupArray);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var intercalate = /* #__PURE__ */ Data_Array.intercalate(Data_Monoid.monoidString);
var SimulationSetup = function (x) {
    return x;
};
var newtypeSimulationSetup_ = {
    Coercible0: function () {
        return undefined;
    }
};
var withSimParams = function (params) {
    return over(SimulationSetup)(function (v) {
        return {
            description: v.description,
            forces: v.forces,
            name: v.name,
            simParams: params
        };
    });
};
var withDescription = function (desc) {
    return over(SimulationSetup)(function (v) {
        return {
            forces: v.forces,
            name: v.name,
            simParams: v.simParams,
            description: new Data_Maybe.Just(desc)
        };
    });
};
var withAlphaTarget = function (target) {
    return function (v) {
        return {
            name: v.name,
            description: v.description,
            forces: v.forces,
            simParams: {
                alpha: v.simParams.alpha,
                alphaMin: v.simParams.alphaMin,
                alphaDecay: v.simParams.alphaDecay,
                velocityDecay: v.simParams.velocityDecay,
                alphaTarget: target
            }
        };
    };
};
var withAlpha = function (alpha) {
    return function (v) {
        return {
            name: v.name,
            description: v.description,
            forces: v.forces,
            simParams: {
                alphaTarget: v.simParams.alphaTarget,
                alphaMin: v.simParams.alphaMin,
                alphaDecay: v.simParams.alphaDecay,
                velocityDecay: v.simParams.velocityDecay,
                alpha: alpha
            }
        };
    };
};
var updateForce = function (name) {
    return function (fn) {
        return function (v) {
            return {
                name: v.name,
                description: v.description,
                simParams: v.simParams,
                forces: map(function (v2) {
                    var $61 = v2.name === name;
                    if ($61) {
                        return fn(v2);
                    };
                    return v2;
                })(v.forces)
            };
        };
    };
};
var setupWithParams = function (name) {
    return function (forces) {
        return function (simParams) {
            return {
                name: name,
                description: Data_Maybe.Nothing.value,
                forces: forces,
                simParams: simParams
            };
        };
    };
};
var replaceForce = function (newForce) {
    return function (v) {
        return {
            name: v.name,
            description: v.description,
            simParams: v.simParams,
            forces: map(function (v2) {
                var $66 = v2.name === newForce.name;
                if ($66) {
                    return newForce;
                };
                return v2;
            })(v.forces)
        };
    };
};
var removeForce = function (name) {
    return function (v) {
        return {
            name: v.name,
            description: v.description,
            simParams: v.simParams,
            forces: Data_Array.filter(function (v2) {
                return v2.name !== name;
            })(v.forces)
        };
    };
};
var mergeSetups = function (v) {
    return function (v1) {
        var setup2ForceNames = map(function (v2) {
            return v2.name;
        })(v1.forces);
        var uniqueFromSetup1 = Data_Array.filter(function (v2) {
            return !elem(v2.name)(setup2ForceNames);
        })(v.forces);
        return {
            name: v.name + ("+" + v1.name),
            description: Data_Maybe.Nothing.value,
            forces: append1(uniqueFromSetup1)(v1.forces),
            simParams: v1.simParams
        };
    };
};
var keepForces = function (names) {
    return function (v) {
        return {
            name: v.name,
            description: v.description,
            simParams: v.simParams,
            forces: Data_Array.filter(function (v2) {
                return elem(v2.name)(names);
            })(v.forces)
        };
    };
};
var hasForce = function (name) {
    return function (v) {
        return Data_Array.any(function (v1) {
            return v1.name === name;
        })(v.forces);
    };
};
var getForce = function (name) {
    return function (v) {
        return Data_Array.find(function (v1) {
            return v1.name === name;
        })(v.forces);
    };
};
var forceNames = function (v) {
    return map(function (v1) {
        return v1.name;
    })(v.forces);
};
var forceCount = function (v) {
    return Data_Array.length(v.forces);
};
var showSimulationSetup = {
    show: function (v) {
        return "Scene \"" + (v.name + ("\" [" + (show(forceCount(v)) + (" forces]: " + intercalate(", ")(map(function (v1) {
            return v1.name;
        })(v.forces))))));
    }
};
var excludeForces = function (names) {
    return function (v) {
        return {
            name: v.name,
            description: v.description,
            simParams: v.simParams,
            forces: Data_Array.filter(function (v2) {
                return !elem(v2.name)(names);
            })(v.forces)
        };
    };
};
var defaultSimParams = {
    alpha: 1.0,
    alphaTarget: 0.0,
    alphaMin: 1.0e-3,
    alphaDecay: 2.28e-2,
    velocityDecay: 0.4
};
var fastSimParams = /* #__PURE__ */ (function () {
    return {
        alpha: defaultSimParams.alpha,
        alphaTarget: defaultSimParams.alphaTarget,
        alphaMin: defaultSimParams.alphaMin,
        alphaDecay: 5.0e-2,
        velocityDecay: 0.6
    };
})();
var setup = function (name) {
    return function (forces) {
        return {
            name: name,
            description: Data_Maybe.Nothing.value,
            forces: forces,
            simParams: defaultSimParams
        };
    };
};
var slowSimParams = /* #__PURE__ */ (function () {
    return {
        alpha: defaultSimParams.alpha,
        alphaTarget: defaultSimParams.alphaTarget,
        alphaMin: defaultSimParams.alphaMin,
        alphaDecay: 1.0e-2,
        velocityDecay: 0.2
    };
})();
var addForce = function (force) {
    return function (v) {
        return {
            name: v.name,
            description: v.description,
            simParams: v.simParams,
            forces: Data_Array.snoc(v.forces)(force)
        };
    };
};
export {
    defaultSimParams,
    fastSimParams,
    slowSimParams,
    SimulationSetup,
    setup,
    setupWithParams,
    withDescription,
    withSimParams,
    withAlpha,
    withAlphaTarget,
    addForce,
    removeForce,
    keepForces,
    excludeForces,
    replaceForce,
    updateForce,
    mergeSetups,
    getForce,
    hasForce,
    forceNames,
    forceCount,
    newtypeSimulationSetup_,
    showSimulationSetup
};
//# sourceMappingURL=index.js.map
