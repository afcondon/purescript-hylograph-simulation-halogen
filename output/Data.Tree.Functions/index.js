// Generated by purs version 0.15.15
import * as Control_Comonad_Cofree from "../Control.Comonad.Cofree/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_List from "../Data.List/index.js";
import * as Data_List_Types from "../Data.List.Types/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Tree from "../Data.Tree/index.js";
var mapFlipped = /* #__PURE__ */ Data_Functor.mapFlipped(Data_List_Types.functorList);
var map = /* #__PURE__ */ Data_Functor.map(Data_List_Types.functorList);
var foldableCofree = /* #__PURE__ */ Control_Comonad_Cofree.foldableCofree(Data_List_Types.foldableList);
var fromFoldable = /* #__PURE__ */ Data_List.fromFoldable(foldableCofree);
var foldl = /* #__PURE__ */ Data_Foldable.foldl(foldableCofree);
var treeMapOverChildren = function (f) {
    return function (tree) {
        var children = Control_Comonad_Cofree.tail(tree);
        var newChildren = mapFlipped(children)(treeMapOverChildren(f));
        return Data_Tree.mkTree(Control_Comonad_Cofree.head(tree))(f(newChildren));
    };
};
var treeMapDeep = function (f) {
    return function (tree) {
        var children = Control_Comonad_Cofree.tail(tree);
        var newChildren = mapFlipped(children)(treeMapDeep(f));
        var newChildData = map(Control_Comonad_Cofree.head)(newChildren);
        return Data_Tree.mkTree(f(Control_Comonad_Cofree.head(tree))(newChildData))(newChildren);
    };
};
var subTree = function (tree) {
    return function (pred) {
        var $6 = pred(Control_Comonad_Cofree.head(tree));
        if ($6) {
            return new Data_Maybe.Just(tree);
        };
        return Data_List.head(Data_List.catMaybes(mapFlipped(Control_Comonad_Cofree.tail(tree))(function (subtree) {
            return subTree(subtree)(pred);
        })));
    };
};
var hasChildren = function (tree) {
    var v = Control_Comonad_Cofree.tail(tree);
    if (v instanceof Data_List_Types.Nil) {
        return false;
    };
    return true;
};
var filterTransformToListRecursive = function (treePredicate) {
    return function (dataTransform) {
        return function (tree) {
            var go = function (subtree) {
                var $8 = treePredicate(subtree);
                if ($8) {
                    return Data_Tree.mkTree(new Data_Maybe.Just(dataTransform(Control_Comonad_Cofree.head(subtree))))(map(go)(Control_Comonad_Cofree.tail(subtree)));
                };
                return Data_Tree.mkTree(Data_Maybe.Nothing.value)(map(go)(Control_Comonad_Cofree.tail(subtree)));
            };
            return Data_List.catMaybes(fromFoldable(go(tree)));
        };
    };
};
var filterTransformToList = function (nodePredicate) {
    return function (dataTransform) {
        return function (tree) {
            var fn = function (acc) {
                return function (d) {
                    var $9 = nodePredicate(d);
                    if ($9) {
                        return new Data_List_Types.Cons(dataTransform(d), acc);
                    };
                    return acc;
                };
            };
            return foldl(fn)(Data_List_Types.Nil.value)(tree);
        };
    };
};
export {
    treeMapDeep,
    treeMapOverChildren,
    hasChildren,
    subTree,
    filterTransformToList,
    filterTransformToListRecursive
};
//# sourceMappingURL=index.js.map
