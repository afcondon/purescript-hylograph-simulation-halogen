// Generated by purs version 0.15.15
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Map_Internal from "../Data.Map.Internal/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Ordering from "../Data.Ordering/index.js";
import * as Data_Set from "../Data.Set/index.js";
import * as Data_Show from "../Data.Show/index.js";
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var show1 = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var compare = /* #__PURE__ */ Data_Ord.compare(Data_Ord.ordInt);
var bind = /* #__PURE__ */ Control_Bind.bind(Data_Maybe.bindMaybe);
var pure = /* #__PURE__ */ Control_Applicative.pure(Data_Maybe.applicativeMaybe);
var compare1 = /* #__PURE__ */ Data_Ord.compare(Data_Ord.ordString);
var NodeID = function (x) {
    return x;
};
var LinkID = function (x) {
    return x;
};
var SourceColor = /* #__PURE__ */ (function () {
    function SourceColor() {

    };
    SourceColor.value = new SourceColor();
    return SourceColor;
})();
var TargetColor = /* #__PURE__ */ (function () {
    function TargetColor() {

    };
    TargetColor.value = new TargetColor();
    return TargetColor;
})();
var SourceTargetGradient = /* #__PURE__ */ (function () {
    function SourceTargetGradient() {

    };
    SourceTargetGradient.value = new SourceTargetGradient();
    return SourceTargetGradient;
})();
var StaticColor = /* #__PURE__ */ (function () {
    function StaticColor(value0) {
        this.value0 = value0;
    };
    StaticColor.create = function (value0) {
        return new StaticColor(value0);
    };
    return StaticColor;
})();
var Link = function (x) {
    return x;
};
var Justify = /* #__PURE__ */ (function () {
    function Justify() {

    };
    Justify.value = new Justify();
    return Justify;
})();
var Left = /* #__PURE__ */ (function () {
    function Left() {

    };
    Left.value = new Left();
    return Left;
})();
var Right = /* #__PURE__ */ (function () {
    function Right() {

    };
    Right.value = new Right();
    return Right;
})();
var Center = /* #__PURE__ */ (function () {
    function Center() {

    };
    Center.value = new Center();
    return Center;
})();
var showNodeID = {
    show: function (v) {
        return "NodeID " + show(v);
    }
};
var show2 = /* #__PURE__ */ Data_Show.show(showNodeID);
var showLinkID = {
    show: function (v) {
        return "LinkID" + show(v);
    }
};
var show3 = /* #__PURE__ */ Data_Show.show(showLinkID);
var showLinkColorMode = {
    show: function (v) {
        if (v instanceof SourceColor) {
            return "source";
        };
        if (v instanceof TargetColor) {
            return "target";
        };
        if (v instanceof SourceTargetGradient) {
            return "source-target";
        };
        if (v instanceof StaticColor) {
            return "static(" + (v.value0 + ")");
        };
        throw new Error("Failed pattern match at DataViz.Layout.Sankey.Types (line 150, column 1 - line 154, column 47): " + [ v.constructor.name ]);
    }
};
var showLink = {
    show: function (v) {
        return "Link: " + (show2(v.source) + (", " + (show2(v.target) + (", " + (show1(v.value) + (", " + show3(v.id)))))));
    }
};
var showAlignment = {
    show: function (v) {
        if (v instanceof Justify) {
            return "justify";
        };
        if (v instanceof Left) {
            return "left";
        };
        if (v instanceof Right) {
            return "right";
        };
        if (v instanceof Center) {
            return "center";
        };
        throw new Error("Failed pattern match at DataViz.Layout.Sankey.Types (line 134, column 1 - line 138, column 25): " + [ v.constructor.name ]);
    }
};
var initialiseSankeyLink = function (l) {
    return {
        sourceIndex: l.source,
        targetIndex: l.target,
        value: l.value,
        width: 0.0,
        y0: 0.0,
        y1: 0.0,
        color: "",
        index: l.id
    };
};
var initialSankeyGraphModel = function (config) {
    return {
        linkCount: 0,
        nodeCount: 0,
        nodeNameToID: Data_Map_Internal.empty,
        nodeIDToName: Data_Map_Internal.empty,
        nodeOrder: [  ],
        deps: Data_Map_Internal.empty,
        sped: Data_Map_Internal.empty,
        sankeyNodes: [  ],
        sankeyLinks: [  ],
        config: config,
        capturedSteps: [  ]
    };
};
var eqNodeID = {
    eq: function (x) {
        return function (y) {
            return x === y;
        };
    }
};
var ordNodeID = {
    compare: function (x) {
        return function (y) {
            return compare(x)(y);
        };
    },
    Eq0: function () {
        return eqNodeID;
    }
};
var lookup = /* #__PURE__ */ Data_Map_Internal.lookup(ordNodeID);
var initialiseSankeyNode = function (m) {
    return function (id) {
        return bind(lookup(id)(m.nodeIDToName))(function (name) {
            var sourceLinks = Data_Maybe.fromMaybe(Data_Set.empty)(lookup(id)(m.deps));
            var targetLinks = Data_Maybe.fromMaybe(Data_Set.empty)(lookup(id)(m.sped));
            return pure({
                name: name,
                x0: 0.0,
                x1: 0.0,
                y0: 0.0,
                y1: 0.0,
                value: 0.0,
                depth: 0,
                nodeHeight: 0,
                layer: 0,
                index: id,
                color: "",
                sourceLinks: sourceLinks,
                targetLinks: targetLinks
            });
        });
    };
};
var eqLinkID = {
    eq: function (x) {
        return function (y) {
            return x === y;
        };
    }
};
var ordLinkID = {
    compare: function (x) {
        return function (y) {
            return compare(x)(y);
        };
    },
    Eq0: function () {
        return eqLinkID;
    }
};
var eqLinkColorMode = {
    eq: function (x) {
        return function (y) {
            if (x instanceof SourceColor && y instanceof SourceColor) {
                return true;
            };
            if (x instanceof TargetColor && y instanceof TargetColor) {
                return true;
            };
            if (x instanceof SourceTargetGradient && y instanceof SourceTargetGradient) {
                return true;
            };
            if (x instanceof StaticColor && y instanceof StaticColor) {
                return x.value0 === y.value0;
            };
            return false;
        };
    }
};
var ordLinkColorMode = {
    compare: function (x) {
        return function (y) {
            if (x instanceof SourceColor && y instanceof SourceColor) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof SourceColor) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof SourceColor) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof TargetColor && y instanceof TargetColor) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof TargetColor) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof TargetColor) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof SourceTargetGradient && y instanceof SourceTargetGradient) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof SourceTargetGradient) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof SourceTargetGradient) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof StaticColor && y instanceof StaticColor) {
                return compare1(x.value0)(y.value0);
            };
            throw new Error("Failed pattern match at DataViz.Layout.Sankey.Types (line 0, column 0 - line 0, column 0): " + [ x.constructor.name, y.constructor.name ]);
        };
    },
    Eq0: function () {
        return eqLinkColorMode;
    }
};
var eqAlignment = {
    eq: function (x) {
        return function (y) {
            if (x instanceof Justify && y instanceof Justify) {
                return true;
            };
            if (x instanceof Left && y instanceof Left) {
                return true;
            };
            if (x instanceof Right && y instanceof Right) {
                return true;
            };
            if (x instanceof Center && y instanceof Center) {
                return true;
            };
            return false;
        };
    }
};
var ordAlignment = {
    compare: function (x) {
        return function (y) {
            if (x instanceof Justify && y instanceof Justify) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof Justify) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof Justify) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof Left && y instanceof Left) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof Left) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof Left) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof Right && y instanceof Right) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof Right) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof Right) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof Center && y instanceof Center) {
                return Data_Ordering.EQ.value;
            };
            throw new Error("Failed pattern match at DataViz.Layout.Sankey.Types (line 0, column 0 - line 0, column 0): " + [ x.constructor.name, y.constructor.name ]);
        };
    },
    Eq0: function () {
        return eqAlignment;
    }
};
var defaultSankeyConfig = function (width) {
    return function (height) {
        return {
            alignment: Justify.value,
            linkColorMode: SourceTargetGradient.value,
            nodeWidth: 15.0,
            nodePadding: 10.0,
            iterations: 6,
            extent: {
                x0: 1.0,
                y0: 1.0,
                x1: width - 1.0,
                y1: height - 5.0
            }
        };
    };
};
export {
    NodeID,
    LinkID,
    Link,
    initialiseSankeyLink,
    Justify,
    Left,
    Right,
    Center,
    SourceColor,
    TargetColor,
    SourceTargetGradient,
    StaticColor,
    defaultSankeyConfig,
    initialSankeyGraphModel,
    initialiseSankeyNode,
    eqNodeID,
    ordNodeID,
    showNodeID,
    eqLinkID,
    ordLinkID,
    showLinkID,
    showLink,
    eqAlignment,
    ordAlignment,
    showAlignment,
    eqLinkColorMode,
    ordLinkColorMode,
    showLinkColorMode
};
//# sourceMappingURL=index.js.map
