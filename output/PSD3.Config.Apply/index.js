// Generated by purs version 0.15.15
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Function_Uncurried from "../Data.Function.Uncurried/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Effect from "../Effect/index.js";
import * as PSD3_Config_Force from "../PSD3.Config.Force/index.js";
import * as PSD3_Internal_FFI from "../PSD3.Internal.FFI/index.js";
var pure = /* #__PURE__ */ Control_Applicative.pure(Effect.applicativeEffect);
var for_ = /* #__PURE__ */ Data_Foldable.for_(Effect.applicativeEffect)(Data_Foldable.foldableArray);
var removeForceFromSimulation = function (name) {
    return function (simulation) {
        var v = PSD3_Internal_FFI.setAsNullForceInSimulation_(simulation)(name);
        return pure(Data_Unit.unit);
    };
};
var removeAllForces = function (simulation) {
    var commonNames = [ "charge", "charge2", "chargetree", "chargePack", "collision", "collide2", "collidePack", "center", "centerStrong", "links", "packageOrbit", "moduleOrbit", "clusterX", "clusterX_M", "clusterY", "clusterY_M", "forceX", "forceY", "radial" ];
    return for_(commonNames)(function (name) {
        var v = PSD3_Internal_FFI.setAsNullForceInSimulation_(simulation)(name);
        return pure(Data_Unit.unit);
    });
};
var createForceHandle = function (v) {
    if (v.forceType instanceof PSD3_Config_Force.ForceManyBody) {
        return PSD3_Internal_FFI.forceMany_(Data_Unit.unit);
    };
    if (v.forceType instanceof PSD3_Config_Force.ForceCenter) {
        return PSD3_Internal_FFI.forceCenter_(Data_Unit.unit);
    };
    if (v.forceType instanceof PSD3_Config_Force.ForceCollide) {
        return PSD3_Internal_FFI.forceCollideFn_(Data_Unit.unit);
    };
    if (v.forceType instanceof PSD3_Config_Force.ForceX) {
        return PSD3_Internal_FFI.forceX_(Data_Unit.unit);
    };
    if (v.forceType instanceof PSD3_Config_Force.ForceY) {
        return PSD3_Internal_FFI.forceY_(Data_Unit.unit);
    };
    if (v.forceType instanceof PSD3_Config_Force.ForceRadial) {
        return PSD3_Internal_FFI.forceRadial_(Data_Unit.unit);
    };
    if (v.forceType instanceof PSD3_Config_Force.ForceLink) {
        return PSD3_Internal_FFI.forceLink_(Data_Unit.unit);
    };
    throw new Error("Failed pattern match at PSD3.Config.Apply (line 112, column 42 - line 119, column 35): " + [ v.forceType.constructor.name ]);
};
var clearAllTickFunctions = function (simulation) {
    var tickNames = [ "nodes", "links" ];
    return for_(tickNames)(function (name) {
        var v = PSD3_Internal_FFI.disableTick_(simulation)(name);
        return pure(Data_Unit.unit);
    });
};
var attrValueToJS = function (v) {
    if (v instanceof PSD3_Config_Force.StaticValue) {
        return v.value0;
    };
    if (v instanceof PSD3_Config_Force.DynamicValue) {
        return v.value0;
    };
    if (v instanceof PSD3_Config_Force.DynamicIndexedValue) {
        return Data_Function_Uncurried.mkFn2(v.value0);
    };
    throw new Error("Failed pattern match at PSD3.Config.Apply (line 197, column 17 - line 200, column 52): " + [ v.constructor.name ]);
};
var setParam = function (handle) {
    return function (paramName) {
        return function (attrValue) {
            var value = attrValueToJS(attrValue);
            var v = (function () {
                if (paramName === "strength") {
                    return PSD3_Internal_FFI.setForceStrength_(handle)(value);
                };
                if (paramName === "radius") {
                    return PSD3_Internal_FFI.setForceRadius_(handle)(value);
                };
                if (paramName === "theta") {
                    return PSD3_Internal_FFI.setForceTheta_(handle)(value);
                };
                if (paramName === "distanceMin") {
                    return PSD3_Internal_FFI.setForceDistanceMin_(handle)(value);
                };
                if (paramName === "distanceMax") {
                    return PSD3_Internal_FFI.setForceDistanceMax_(handle)(value);
                };
                if (paramName === "iterations") {
                    return PSD3_Internal_FFI.setForceIterations_(handle)(value);
                };
                if (paramName === "x") {
                    return PSD3_Internal_FFI.setForceX_(handle)(value);
                };
                if (paramName === "y") {
                    return PSD3_Internal_FFI.setForceY_(handle)(value);
                };
                if (paramName === "distance") {
                    return PSD3_Internal_FFI.setForceDistance_(handle)(value);
                };
                return handle;
            })();
            return pure(Data_Unit.unit);
        };
    };
};
var applySimulationParams = function (params) {
    return function (simulation) {
        var v = PSD3_Internal_FFI.setAlpha_(simulation)(params.alpha);
        var v1 = PSD3_Internal_FFI.setAlphaTarget_(simulation)(params.alphaTarget);
        var v2 = PSD3_Internal_FFI.setAlphaMin_(simulation)(params.alphaMin);
        var v3 = PSD3_Internal_FFI.setAlphaDecay_(simulation)(params.alphaDecay);
        var v4 = PSD3_Internal_FFI.setVelocityDecay_(simulation)(params.velocityDecay);
        return pure(Data_Unit.unit);
    };
};
var applyFilterToAttr = function (predicate) {
    return function (v) {
        if (v instanceof PSD3_Config_Force.StaticValue) {
            return new PSD3_Config_Force.DynamicValue(function (datum) {
                var $29 = predicate(datum);
                if ($29) {
                    return v.value0;
                };
                return 0.0;
            });
        };
        if (v instanceof PSD3_Config_Force.DynamicValue) {
            return new PSD3_Config_Force.DynamicValue(function (datum) {
                var $31 = predicate(datum);
                if ($31) {
                    return v.value0(datum);
                };
                return 0.0;
            });
        };
        if (v instanceof PSD3_Config_Force.DynamicIndexedValue) {
            return new PSD3_Config_Force.DynamicIndexedValue(function (datum) {
                return function (idx) {
                    var $33 = predicate(datum);
                    if ($33) {
                        return v.value0(datum)(idx);
                    };
                    return 0.0;
                };
            });
        };
        throw new Error("Failed pattern match at PSD3.Config.Apply (line 205, column 31 - line 216, column 52): " + [ v.constructor.name ]);
    };
};
var applyParam = function (handle) {
    return function (maybeFilter) {
        return function (paramName) {
            return function (attrValue) {
                if (maybeFilter instanceof Data_Maybe.Nothing) {
                    return setParam(handle)(paramName)(attrValue);
                };
                if (maybeFilter instanceof Data_Maybe.Just) {
                    return setParam(handle)(paramName)(applyFilterToAttr(maybeFilter.value0.value0.predicate)(attrValue));
                };
                throw new Error("Failed pattern match at PSD3.Config.Apply (line 165, column 3 - line 172, column 79): " + [ maybeFilter.constructor.name ]);
            };
        };
    };
};
var applyForceParams = function (handle) {
    return function (maybeFilter) {
        return function (params) {
            if (params instanceof PSD3_Config_Force.ManyBodyParams) {
                return function __do() {
                    applyParam(handle)(maybeFilter)("strength")(params.value0.strength)();
                    applyParam(handle)(Data_Maybe.Nothing.value)("theta")(params.value0.theta)();
                    applyParam(handle)(Data_Maybe.Nothing.value)("distanceMin")(params.value0.distanceMin)();
                    return applyParam(handle)(Data_Maybe.Nothing.value)("distanceMax")(params.value0.distanceMax)();
                };
            };
            if (params instanceof PSD3_Config_Force.CenterParams) {
                return function __do() {
                    applyParam(handle)(Data_Maybe.Nothing.value)("x")(params.value0.x)();
                    applyParam(handle)(Data_Maybe.Nothing.value)("y")(params.value0.y)();
                    return applyParam(handle)(maybeFilter)("strength")(params.value0.strength)();
                };
            };
            if (params instanceof PSD3_Config_Force.CollideParams) {
                return function __do() {
                    applyParam(handle)(maybeFilter)("radius")(params.value0.radius)();
                    applyParam(handle)(maybeFilter)("strength")(params.value0.strength)();
                    return applyParam(handle)(Data_Maybe.Nothing.value)("iterations")(params.value0.iterations)();
                };
            };
            if (params instanceof PSD3_Config_Force.ForceXParams) {
                return function __do() {
                    applyParam(handle)(Data_Maybe.Nothing.value)("x")(params.value0.x)();
                    return applyParam(handle)(maybeFilter)("strength")(params.value0.strength)();
                };
            };
            if (params instanceof PSD3_Config_Force.ForceYParams) {
                return function __do() {
                    applyParam(handle)(Data_Maybe.Nothing.value)("y")(params.value0.y)();
                    return applyParam(handle)(maybeFilter)("strength")(params.value0.strength)();
                };
            };
            if (params instanceof PSD3_Config_Force.RadialParams) {
                return function __do() {
                    applyParam(handle)(maybeFilter)("radius")(params.value0.radius)();
                    applyParam(handle)(maybeFilter)("strength")(params.value0.strength)();
                    applyParam(handle)(Data_Maybe.Nothing.value)("x")(params.value0.x)();
                    return applyParam(handle)(Data_Maybe.Nothing.value)("y")(params.value0.y)();
                };
            };
            if (params instanceof PSD3_Config_Force.LinkParams) {
                return function __do() {
                    applyParam(handle)(Data_Maybe.Nothing.value)("distance")(params.value0.distance)();
                    applyParam(handle)(maybeFilter)("strength")(params.value0.strength)();
                    return applyParam(handle)(Data_Maybe.Nothing.value)("iterations")(params.value0.iterations)();
                };
            };
            throw new Error("Failed pattern match at PSD3.Config.Apply (line 125, column 46 - line 159, column 56): " + [ params.constructor.name ]);
        };
    };
};
var applySimulationSetup = function (v) {
    return function (simulation) {
        return function __do() {
            clearAllTickFunctions(simulation)();
            removeAllForces(simulation)();
            for_(v.forces)(function (forceConfig) {
                var handle = createForceHandle(forceConfig);
                return function __do() {
                    applyForceParams(handle)(forceConfig.filter)(forceConfig.params)();
                    var v1 = PSD3_Internal_FFI.putForceInSimulation_(simulation)(forceConfig.name)(handle);
                    return Data_Unit.unit;
                };
            })();
            return applySimulationParams(v.simParams)(simulation)();
        };
    };
};
var updateForceParams = function (forceConfig) {
    return function (simulation) {
        var handle = createForceHandle(forceConfig);
        return function __do() {
            applyForceParams(handle)(forceConfig.filter)(forceConfig.params)();
            var v = PSD3_Internal_FFI.putForceInSimulation_(simulation)(forceConfig.name)(handle);
            return Data_Unit.unit;
        };
    };
};
var addForceToSimulation = function (forceConfig) {
    return function (simulation) {
        var handle = createForceHandle(forceConfig);
        return function __do() {
            applyForceParams(handle)(forceConfig.filter)(forceConfig.params)();
            var v = PSD3_Internal_FFI.putForceInSimulation_(simulation)(forceConfig.name)(handle);
            return Data_Unit.unit;
        };
    };
};
export {
    applySimulationSetup,
    clearAllTickFunctions,
    removeAllForces,
    createForceHandle,
    applyForceParams,
    applyParam,
    setParam,
    attrValueToJS,
    applyFilterToAttr,
    applySimulationParams,
    addForceToSimulation,
    removeForceFromSimulation,
    updateForceParams
};
//# sourceMappingURL=index.js.map
