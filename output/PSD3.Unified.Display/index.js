// Generated by purs version 0.15.15
import * as Control_Category from "../Control.Category/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Number from "../Data.Number/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Ring from "../Data.Ring/index.js";
import * as Data_Semigroup from "../Data.Semigroup/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_String_CodePoints from "../Data.String.CodePoints/index.js";
import * as Data_String_CodeUnits from "../Data.String.CodeUnits/index.js";
import * as Data_String_Common from "../Data.String.Common/index.js";
var append1 = /* #__PURE__ */ Data_Semigroup.append(Data_Semigroup.semigroupArray);
var negate = /* #__PURE__ */ Data_Ring.negate(Data_Ring.ringNumber);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var show1 = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var max = /* #__PURE__ */ Data_Ord.max(Data_Ord.ordNumber);
var min = /* #__PURE__ */ Data_Ord.min(Data_Ord.ordNumber);
var Display = function (x) {
    return x;
};
var yesNoD = function (b) {
    if (b) {
        return "Yes";
    };
    return "No";
};
var upperD = Data_String_Common.toUpper;
var trimD = Data_String_Common.trim;
var suffixD = function (s) {
    return function (v) {
        return v + s;
    };
};
var splitAt = function (n) {
    return function (arr) {
        return {
            before: Data_Array.take(n)(arr),
            after: Data_Array.drop(n)(arr)
        };
    };
};
var scaleD = function (factor) {
    return function (v) {
        return v * factor;
    };
};
var runDisplay = function (v) {
    return v;
};
var roundD = function (decimals) {
    return function (n) {
        var factor = Data_Number.pow(10.0)(Data_Int.toNumber(decimals));
        return Data_Number.round(n * factor) / factor;
    };
};
var rmapD = function (f) {
    return function (v) {
        return function ($81) {
            return f(v($81));
        };
    };
};
var reverse = /* #__PURE__ */ Data_Foldable.foldr(Data_Foldable.foldableArray)(function (x) {
    return function (acc) {
        return append1(acc)([ x ]);
    };
})([  ]);
var replicate = function (n) {
    return function (x) {
        var $44 = n <= 0;
        if ($44) {
            return [  ];
        };
        return append1([ x ])(replicate(n - 1 | 0)(x));
    };
};
var repeatChar = function (n) {
    return function (c) {
        return Data_String_CodeUnits.fromCharArray(replicate(n)(c));
    };
};
var prefixD = function (p) {
    return function (v) {
        return p + v;
    };
};
var padRightD = function (width) {
    return function (c) {
        return function (s) {
            var padding = Data_String_CodePoints.fromCodePointArray(replicate(width - Data_String_CodePoints.length(s) | 0)(Data_String_CodePoints.codePointFromChar(c)));
            return s + padding;
        };
    };
};
var padLeftD = function (width) {
    return function (c) {
        return function (s) {
            var padding = Data_String_CodePoints.fromCodePointArray(replicate(width - Data_String_CodePoints.length(s) | 0)(Data_String_CodePoints.codePointFromChar(c)));
            return padding + s;
        };
    };
};
var negateD = negate;
var lowerD = Data_String_Common.toLower;
var lmapD = function (f) {
    return function (v) {
        return function ($82) {
            return v(f($82));
        };
    };
};
var intercalate = function (v) {
    return function (v1) {
        if (Data_Array["null"](v1)) {
            return [  ];
        };
        if (Data_Array.length(v1) === 1) {
            var v2 = Data_Array.head(v1);
            if (v2 instanceof Data_Maybe.Just) {
                return v2.value0;
            };
            if (v2 instanceof Data_Maybe.Nothing) {
                return [  ];
            };
            throw new Error("Failed pattern match at PSD3.Unified.Display (line 392, column 45 - line 394, column 16): " + [ v2.constructor.name ]);
        };
        var v2 = Data_Array.uncons(v1);
        if (v2 instanceof Data_Maybe.Just) {
            return append1(v2.value0.head)(append1(v)(intercalate(v)(v2.value0.tail)));
        };
        if (v2 instanceof Data_Maybe.Nothing) {
            return [  ];
        };
        throw new Error("Failed pattern match at PSD3.Unified.Display (line 395, column 23 - line 397, column 16): " + [ v2.constructor.name ]);
    };
};
var intD = function ($83) {
    return show(Data_Int.round($83));
};
var idD = /* #__PURE__ */ Control_Category.identity(Control_Category.categoryFn);
var groupsOf = function (v) {
    return function (v1) {
        if (Data_Array["null"](v1)) {
            return [  ];
        };
        var v2 = splitAt(v)(v1);
        return append1([ v2.before ])(groupsOf(v)(v2.after));
    };
};
var insertThousandsSeparators = function (s) {
    var insertSeps = function (str) {
        var chars = Data_String_CodeUnits.toCharArray(str);
        var reversed = reverse(chars);
        var grouped = groupsOf(3)(reversed);
        var withCommas = intercalate([ "," ])(grouped);
        return Data_String_CodeUnits.fromCharArray(reverse(withCommas));
    };
    var v = Data_String_CodePoints.indexOf(".")(s);
    if (v instanceof Data_Maybe.Nothing) {
        return insertSeps(s);
    };
    if (v instanceof Data_Maybe.Just) {
        var intPart = Data_String_CodePoints.take(v.value0)(s);
        var decPart = Data_String_CodePoints.drop(v.value0)(s);
        return insertSeps(intPart) + decPart;
    };
    throw new Error("Failed pattern match at PSD3.Unified.Display (line 366, column 3 - line 371, column 39): " + [ v.constructor.name ]);
};
var thousandsD = insertThousandsSeparators;
var floorD = Data_Number.floor;
var ensureDecimals = function (n) {
    return function (str) {
        var v = Data_String_CodePoints.indexOf(".")(str);
        if (v instanceof Data_Maybe.Nothing) {
            return str + ("." + repeatChar(n)("0"));
        };
        if (v instanceof Data_Maybe.Just) {
            var decimals = (Data_String_CodePoints.length(str) - v.value0 | 0) - 1 | 0;
            var $63 = decimals < n;
            if ($63) {
                return str + repeatChar(n - decimals | 0)("0");
            };
            return str;
        };
        throw new Error("Failed pattern match at PSD3.Unified.Display (line 348, column 3 - line 354, column 20): " + [ v.constructor.name ]);
    };
};
var formatFixed = function (decimals) {
    return function (n) {
        var factor = Data_Number.pow(10.0)(Data_Int.toNumber(decimals));
        var rounded = Data_Number.round(n * factor) / factor;
        var str = show1(rounded);
        return ensureDecimals(decimals)(str);
    };
};
var fixedD = function (decimals) {
    return formatFixed(decimals);
};
var formatScientific = function (precision) {
    return function (n) {
        var exponent = Data_Number.floor(Data_Number.log(n) / Data_Number.ln10);
        var mantissa = n / Data_Number.pow(10.0)(exponent);
        return formatFixed(precision)(mantissa) + ("e" + show(Data_Int.round(exponent)));
    };
};
var sciD = function (precision) {
    return formatScientific(precision);
};
var dropWhileArray = function ($copy_pred) {
    return function ($copy_arr) {
        var $tco_var_pred = $copy_pred;
        var $tco_done = false;
        var $tco_result;
        function $tco_loop(pred, arr) {
            var v = Data_Array.uncons(arr);
            if (v instanceof Data_Maybe.Nothing) {
                $tco_done = true;
                return [  ];
            };
            if (v instanceof Data_Maybe.Just) {
                var $66 = pred(v.value0.head);
                if ($66) {
                    $tco_var_pred = pred;
                    $copy_arr = v.value0.tail;
                    return;
                };
                $tco_done = true;
                return arr;
            };
            throw new Error("Failed pattern match at PSD3.Unified.Display (line 421, column 27 - line 426, column 15): " + [ v.constructor.name ]);
        };
        while (!$tco_done) {
            $tco_result = $tco_loop($tco_var_pred, $copy_arr);
        };
        return $tco_result;
    };
};
var dropWhileEnd = function (pred) {
    return function (arr) {
        return reverse(dropWhileArray(pred)(reverse(arr)));
    };
};
var dropRightWhile = function (pred) {
    return function (s) {
        var chars = Data_String_CodeUnits.toCharArray(s);
        var trimmed = dropWhileEnd(pred)(chars);
        return Data_String_CodeUnits.fromCharArray(trimmed);
    };
};
var trimTrailingZeros = function (s) {
    var $70 = Data_String_CodeUnits.contains(".")(s);
    if ($70) {
        return dropRightWhile(function (c) {
            return c === "0";
        })(dropRightWhile(function (c) {
            return c === ".";
        })(s));
    };
    return s;
};
var formatNumber = function (n) {
    var rounded = Data_Number.round(n);
    var $71 = n === rounded;
    if ($71) {
        return show(Data_Int.round(n));
    };
    return trimTrailingZeros(show1(n));
};
var showNumD = formatNumber;
var signedD = function (n) {
    var $72 = n < 0.0;
    if ($72) {
        return "(" + (formatNumber(-n) + ")");
    };
    return formatNumber(n);
};
var dimapD = function (f) {
    return function (g) {
        return function (v) {
            return function ($84) {
                return g(v(f($84)));
            };
        };
    };
};
var composeD = function (v) {
    return function (v1) {
        return function ($85) {
            return v1(v($85));
        };
    };
};
var currencyWithSymbol = function (symbol) {
    return composeD(composeD(composeD(roundD(2))(showNumD))(thousandsD))(prefixD(symbol));
};
var currencyD = /* #__PURE__ */ currencyWithSymbol("$");
var percentageD = /* #__PURE__ */ composeD(/* #__PURE__ */ composeD(/* #__PURE__ */ composeD(/* #__PURE__ */ scaleD(100.0))(/* #__PURE__ */ roundD(1)))(showNumD))(/* #__PURE__ */ suffixD("%"));
var compactD = function (n) {
    var $78 = n >= 1000000.0;
    if ($78) {
        return formatNumber(n / 1000000.0) + "M";
    };
    var $79 = n >= 1000.0;
    if ($79) {
        return formatNumber(n / 1000.0) + "K";
    };
    return formatNumber(n);
};
var clampD = function (lo) {
    return function (hi) {
        return function (n) {
            return max(lo)(min(hi)(n));
        };
    };
};
var ceilD = Data_Number.ceil;
var boolD = /* #__PURE__ */ Data_Show.show(Data_Show.showBoolean);
var absD = function (n) {
    var $80 = n < 0.0;
    if ($80) {
        return -n;
    };
    return n;
};
export {
    Display,
    runDisplay,
    idD,
    composeD,
    lmapD,
    rmapD,
    dimapD,
    roundD,
    scaleD,
    clampD,
    absD,
    negateD,
    floorD,
    ceilD,
    showNumD,
    fixedD,
    sciD,
    intD,
    prefixD,
    suffixD,
    padLeftD,
    padRightD,
    upperD,
    lowerD,
    trimD,
    percentageD,
    currencyD,
    currencyWithSymbol,
    thousandsD,
    signedD,
    compactD,
    boolD,
    yesNoD
};
//# sourceMappingURL=index.js.map
