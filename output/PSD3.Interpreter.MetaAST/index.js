// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Generic_Rep from "../Data.Generic.Rep/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Monoid from "../Data.Monoid/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as PSD3_AST from "../PSD3.AST/index.js";
import * as PSD3_Internal_Selection_Types from "../PSD3.Internal.Selection.Types/index.js";
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var intercalate = /* #__PURE__ */ Data_Array.intercalate(Data_Monoid.monoidString);
var show1 = /* #__PURE__ */ Data_Show.show(Data_Show.showBoolean);
var NodeAST = /* #__PURE__ */ (function () {
    function NodeAST(value0) {
        this.value0 = value0;
    };
    NodeAST.create = function (value0) {
        return new NodeAST(value0);
    };
    return NodeAST;
})();
var JoinAST = /* #__PURE__ */ (function () {
    function JoinAST(value0) {
        this.value0 = value0;
    };
    JoinAST.create = function (value0) {
        return new JoinAST(value0);
    };
    return JoinAST;
})();
var NestedJoinAST = /* #__PURE__ */ (function () {
    function NestedJoinAST(value0) {
        this.value0 = value0;
    };
    NestedJoinAST.create = function (value0) {
        return new NestedJoinAST(value0);
    };
    return NestedJoinAST;
})();
var UpdateJoinAST = /* #__PURE__ */ (function () {
    function UpdateJoinAST(value0) {
        this.value0 = value0;
    };
    UpdateJoinAST.create = function (value0) {
        return new UpdateJoinAST(value0);
    };
    return UpdateJoinAST;
})();
var UpdateNestedJoinAST = /* #__PURE__ */ (function () {
    function UpdateNestedJoinAST(value0) {
        this.value0 = value0;
    };
    UpdateNestedJoinAST.create = function (value0) {
        return new UpdateNestedJoinAST(value0);
    };
    return UpdateNestedJoinAST;
})();
var ConditionalRenderAST = /* #__PURE__ */ (function () {
    function ConditionalRenderAST(value0) {
        this.value0 = value0;
    };
    ConditionalRenderAST.create = function (value0) {
        return new ConditionalRenderAST(value0);
    };
    return ConditionalRenderAST;
})();
var LocalCoordSpaceAST = /* #__PURE__ */ (function () {
    function LocalCoordSpaceAST(value0) {
        this.value0 = value0;
    };
    LocalCoordSpaceAST.create = function (value0) {
        return new LocalCoordSpaceAST(value0);
    };
    return LocalCoordSpaceAST;
})();
var genericTreeAST_ = {
    to: function (x) {
        if (x instanceof Data_Generic_Rep.Inl) {
            return new NodeAST(x.value0);
        };
        if (x instanceof Data_Generic_Rep.Inr && x.value0 instanceof Data_Generic_Rep.Inl) {
            return new JoinAST(x.value0.value0);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0 instanceof Data_Generic_Rep.Inl)) {
            return new NestedJoinAST(x.value0.value0.value0);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0 instanceof Data_Generic_Rep.Inl))) {
            return new UpdateJoinAST(x.value0.value0.value0.value0);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inl)))) {
            return new UpdateNestedJoinAST(x.value0.value0.value0.value0.value0);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inl))))) {
            return new ConditionalRenderAST(x.value0.value0.value0.value0.value0.value0);
        };
        if (x instanceof Data_Generic_Rep.Inr && (x.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0 instanceof Data_Generic_Rep.Inr && (x.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr && x.value0.value0.value0.value0.value0 instanceof Data_Generic_Rep.Inr))))) {
            return new LocalCoordSpaceAST(x.value0.value0.value0.value0.value0.value0);
        };
        throw new Error("Failed pattern match at PSD3.Interpreter.MetaAST (line 65, column 1 - line 65, column 34): " + [ x.constructor.name ]);
    },
    from: function (x) {
        if (x instanceof NodeAST) {
            return new Data_Generic_Rep.Inl(x.value0);
        };
        if (x instanceof JoinAST) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(x.value0));
        };
        if (x instanceof NestedJoinAST) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(x.value0)));
        };
        if (x instanceof UpdateJoinAST) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(x.value0))));
        };
        if (x instanceof UpdateNestedJoinAST) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(x.value0)))));
        };
        if (x instanceof ConditionalRenderAST) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inl(x.value0))))));
        };
        if (x instanceof LocalCoordSpaceAST) {
            return new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(new Data_Generic_Rep.Inr(x.value0))))));
        };
        throw new Error("Failed pattern match at PSD3.Interpreter.MetaAST (line 65, column 1 - line 65, column 34): " + [ x.constructor.name ]);
    }
};
var showElemType = function (v) {
    if (v instanceof PSD3_Internal_Selection_Types.SVG) {
        return "SVG";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Group) {
        return "Group";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Circle) {
        return "Circle";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Rect) {
        return "Rect";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Path) {
        return "Path";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Line) {
        return "Line";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Polygon) {
        return "Polygon";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Text) {
        return "Text";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Div) {
        return "Div";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Span) {
        return "Span";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Table) {
        return "Table";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Tbody) {
        return "Tbody";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Thead) {
        return "Thead";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Tr) {
        return "Tr";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Td) {
        return "Td";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Th) {
        return "Th";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Defs) {
        return "Defs";
    };
    if (v instanceof PSD3_Internal_Selection_Types.LinearGradient) {
        return "LinearGradient";
    };
    if (v instanceof PSD3_Internal_Selection_Types.Stop) {
        return "Stop";
    };
    if (v instanceof PSD3_Internal_Selection_Types.PatternFill) {
        return "PatternFill";
    };
    throw new Error("Failed pattern match at PSD3.Interpreter.MetaAST (line 216, column 1 - line 216, column 38): " + [ v.constructor.name ]);
};
var toAST = function (tree) {
    if (tree instanceof PSD3_AST.Node) {
        return new NodeAST({
            name: tree.value0.name,
            elemType: showElemType(tree.value0.elemType),
            attrCount: Data_Array.length(tree.value0.attrs),
            children: map(toAST)(tree.value0.children)
        });
    };
    if (tree instanceof PSD3_AST.Join) {
        return new JoinAST({
            name: tree.value0.name,
            key: tree.value0.key,
            dataCount: Data_Array.length(tree.value0.joinData),
            hasTemplate: true
        });
    };
    if (tree instanceof PSD3_AST.NestedJoin) {
        return new NestedJoinAST({
            name: tree.value0.name,
            key: tree.value0.key,
            dataCount: Data_Array.length(tree.value0.joinData),
            hasTemplate: true
        });
    };
    if (tree instanceof PSD3_AST.UpdateJoin) {
        return new UpdateJoinAST({
            name: tree.value0.name,
            key: tree.value0.key,
            dataCount: Data_Array.length(tree.value0.joinData),
            hasEnter: (function () {
                if (tree.value0.behaviors.enter instanceof Data_Maybe.Just) {
                    return true;
                };
                if (tree.value0.behaviors.enter instanceof Data_Maybe.Nothing) {
                    return false;
                };
                throw new Error("Failed pattern match at PSD3.Interpreter.MetaAST (line 99, column 19 - line 101, column 27): " + [ tree.value0.behaviors.enter.constructor.name ]);
            })(),
            hasUpdate: (function () {
                if (tree.value0.behaviors.update instanceof Data_Maybe.Just) {
                    return true;
                };
                if (tree.value0.behaviors.update instanceof Data_Maybe.Nothing) {
                    return false;
                };
                throw new Error("Failed pattern match at PSD3.Interpreter.MetaAST (line 102, column 20 - line 104, column 27): " + [ tree.value0.behaviors.update.constructor.name ]);
            })(),
            hasExit: (function () {
                if (tree.value0.behaviors.exit instanceof Data_Maybe.Just) {
                    return true;
                };
                if (tree.value0.behaviors.exit instanceof Data_Maybe.Nothing) {
                    return false;
                };
                throw new Error("Failed pattern match at PSD3.Interpreter.MetaAST (line 105, column 18 - line 107, column 27): " + [ tree.value0.behaviors.exit.constructor.name ]);
            })(),
            hasTemplate: true
        });
    };
    if (tree instanceof PSD3_AST.UpdateNestedJoin) {
        return new UpdateNestedJoinAST({
            name: tree.value0.name,
            key: tree.value0.key,
            dataCount: Data_Array.length(tree.value0.joinData),
            hasEnter: (function () {
                if (tree.value0.behaviors.enter instanceof Data_Maybe.Just) {
                    return true;
                };
                if (tree.value0.behaviors.enter instanceof Data_Maybe.Nothing) {
                    return false;
                };
                throw new Error("Failed pattern match at PSD3.Interpreter.MetaAST (line 116, column 19 - line 118, column 27): " + [ tree.value0.behaviors.enter.constructor.name ]);
            })(),
            hasUpdate: (function () {
                if (tree.value0.behaviors.update instanceof Data_Maybe.Just) {
                    return true;
                };
                if (tree.value0.behaviors.update instanceof Data_Maybe.Nothing) {
                    return false;
                };
                throw new Error("Failed pattern match at PSD3.Interpreter.MetaAST (line 119, column 20 - line 121, column 27): " + [ tree.value0.behaviors.update.constructor.name ]);
            })(),
            hasExit: (function () {
                if (tree.value0.behaviors.exit instanceof Data_Maybe.Just) {
                    return true;
                };
                if (tree.value0.behaviors.exit instanceof Data_Maybe.Nothing) {
                    return false;
                };
                throw new Error("Failed pattern match at PSD3.Interpreter.MetaAST (line 122, column 18 - line 124, column 27): " + [ tree.value0.behaviors.exit.constructor.name ]);
            })(),
            hasTemplate: true
        });
    };
    if (tree instanceof PSD3_AST.ConditionalRender) {
        return new ConditionalRenderAST({
            caseCount: Data_Array.length(tree.value0.cases)
        });
    };
    if (tree instanceof PSD3_AST.LocalCoordSpace) {
        return new LocalCoordSpaceAST({
            child: toAST(tree.value0.child)
        });
    };
    throw new Error("Failed pattern match at PSD3.Interpreter.MetaAST (line 69, column 14 - line 136, column 8): " + [ tree.constructor.name ]);
};
var prettyPrintAST = function (ast) {
    var power = function (v) {
        return function (v1) {
            if (v1 === 0) {
                return "";
            };
            return v + power(v)(v1 - 1 | 0);
        };
    };
    var indent = function (n) {
        return power("  ")(n);
    };
    var prettyPrint = function (tree) {
        return function (level) {
            if (tree instanceof NodeAST) {
                var nameStr = (function () {
                    if (tree.value0.name instanceof Data_Maybe.Just) {
                        return "\"" + (tree.value0.name.value0 + "\"");
                    };
                    if (tree.value0.name instanceof Data_Maybe.Nothing) {
                        return "anonymous";
                    };
                    throw new Error("Failed pattern match at PSD3.Interpreter.MetaAST (line 145, column 23 - line 147, column 37): " + [ tree.value0.name.constructor.name ]);
                })();
                var childrenStr = (function () {
                    var $102 = Data_Array.length(tree.value0.children) > 0;
                    if ($102) {
                        return "\x0a" + (indent(level + 1 | 0) + (", children: " + (show(Data_Array.length(tree.value0.children)) + (" nodes\x0a" + intercalate("\x0a")(map(function (c) {
                            return prettyPrint(c)(level + 2 | 0);
                        })(tree.value0.children))))));
                    };
                    return "";
                })();
                return indent(level) + ("NodeAST\x0a" + (indent(level + 1 | 0) + ("{ name: " + (nameStr + ("\x0a" + (indent(level + 1 | 0) + (", elemType: " + (tree.value0.elemType + ("\x0a" + (indent(level + 1 | 0) + (", attrCount: " + (show(tree.value0.attrCount) + (childrenStr + ("\x0a" + (indent(level) + "}")))))))))))))));
            };
            if (tree instanceof JoinAST) {
                return indent(level) + ("JoinAST\x0a" + (indent(level + 1 | 0) + ("{ name: \"" + (tree.value0.name + ("\"\x0a" + (indent(level + 1 | 0) + (", key: \"" + (tree.value0.key + ("\"\x0a" + (indent(level + 1 | 0) + (", dataCount: " + (show(tree.value0.dataCount) + ("\x0a" + (indent(level + 1 | 0) + (", hasTemplate: " + (show1(tree.value0.hasTemplate) + ("\x0a" + (indent(level) + "}"))))))))))))))))));
            };
            if (tree instanceof NestedJoinAST) {
                return indent(level) + ("NestedJoinAST\x0a" + (indent(level + 1 | 0) + ("{ name: \"" + (tree.value0.name + ("\"\x0a" + (indent(level + 1 | 0) + (", key: \"" + (tree.value0.key + ("\"\x0a" + (indent(level + 1 | 0) + (", dataCount: " + (show(tree.value0.dataCount) + ("\x0a" + (indent(level + 1 | 0) + (", hasTemplate: " + (show1(tree.value0.hasTemplate) + ("\x0a" + (indent(level) + "}"))))))))))))))))));
            };
            if (tree instanceof UpdateJoinAST) {
                return indent(level) + ("UpdateJoinAST\x0a" + (indent(level + 1 | 0) + ("{ name: \"" + (tree.value0.name + ("\"\x0a" + (indent(level + 1 | 0) + (", key: \"" + (tree.value0.key + ("\"\x0a" + (indent(level + 1 | 0) + (", dataCount: " + (show(tree.value0.dataCount) + ("\x0a" + (indent(level + 1 | 0) + (", hasEnter: " + (show1(tree.value0.hasEnter) + ("\x0a" + (indent(level + 1 | 0) + (", hasUpdate: " + (show1(tree.value0.hasUpdate) + ("\x0a" + (indent(level + 1 | 0) + (", hasExit: " + (show1(tree.value0.hasExit) + ("\x0a" + (indent(level + 1 | 0) + (", hasTemplate: " + (show1(tree.value0.hasTemplate) + ("\x0a" + (indent(level) + "}"))))))))))))))))))))))))))))));
            };
            if (tree instanceof UpdateNestedJoinAST) {
                return indent(level) + ("UpdateNestedJoinAST\x0a" + (indent(level + 1 | 0) + ("{ name: \"" + (tree.value0.name + ("\"\x0a" + (indent(level + 1 | 0) + (", key: \"" + (tree.value0.key + ("\"\x0a" + (indent(level + 1 | 0) + (", dataCount: " + (show(tree.value0.dataCount) + ("\x0a" + (indent(level + 1 | 0) + (", hasEnter: " + (show1(tree.value0.hasEnter) + ("\x0a" + (indent(level + 1 | 0) + (", hasUpdate: " + (show1(tree.value0.hasUpdate) + ("\x0a" + (indent(level + 1 | 0) + (", hasExit: " + (show1(tree.value0.hasExit) + ("\x0a" + (indent(level + 1 | 0) + (", hasTemplate: " + (show1(tree.value0.hasTemplate) + ("\x0a" + (indent(level) + "}"))))))))))))))))))))))))))))));
            };
            if (tree instanceof ConditionalRenderAST) {
                return indent(level) + ("ConditionalRenderAST\x0a" + (indent(level + 1 | 0) + ("{ caseCount: " + (show(tree.value0.caseCount) + ("\x0a" + (indent(level) + "}"))))));
            };
            if (tree instanceof LocalCoordSpaceAST) {
                return indent(level) + ("LocalCoordSpaceAST\x0a" + (indent(level + 1 | 0) + ("{ child:\x0a" + (prettyPrint(tree.value0.child)(level + 2 | 0) + ("\x0a" + (indent(level) + "}"))))));
            };
            throw new Error("Failed pattern match at PSD3.Interpreter.MetaAST (line 143, column 30 - line 206, column 31): " + [ tree.constructor.name ]);
        };
    };
    return prettyPrint(ast)(0);
};
export {
    NodeAST,
    JoinAST,
    NestedJoinAST,
    UpdateJoinAST,
    UpdateNestedJoinAST,
    ConditionalRenderAST,
    LocalCoordSpaceAST,
    toAST,
    prettyPrintAST,
    showElemType,
    genericTreeAST_
};
//# sourceMappingURL=index.js.map
