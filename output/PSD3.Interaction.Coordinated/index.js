// Generated by purs version 0.15.15
import * as $foreign from "./foreign.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Nullable from "../Data.Nullable/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Ordering from "../Data.Ordering/index.js";
import * as Data_Set from "../Data.Set/index.js";
import * as Data_Show from "../Data.Show/index.js";
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showString);
var show1 = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var show2 = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var show3 = /* #__PURE__ */ Data_Show.show(/* #__PURE__ */ Data_Maybe.showMaybe(Data_Show.showString));
var eq2 = /* #__PURE__ */ Data_Eq.eq(/* #__PURE__ */ Data_Set.eqSet(Data_Eq.eqString));
var eq3 = /* #__PURE__ */ Data_Eq.eq(/* #__PURE__ */ Data_Maybe.eqMaybe(Data_Eq.eqString));
var member = /* #__PURE__ */ Data_Set.member(Data_Ord.ordString);
var Primary = /* #__PURE__ */ (function () {
    function Primary() {

    };
    Primary.value = new Primary();
    return Primary;
})();
var Related = /* #__PURE__ */ (function () {
    function Related() {

    };
    Related.value = new Related();
    return Related;
})();
var Selected = /* #__PURE__ */ (function () {
    function Selected() {

    };
    Selected.value = new Selected();
    return Selected;
})();
var Dimmed = /* #__PURE__ */ (function () {
    function Dimmed() {

    };
    Dimmed.value = new Dimmed();
    return Dimmed;
})();
var Neutral = /* #__PURE__ */ (function () {
    function Neutral() {

    };
    Neutral.value = new Neutral();
    return Neutral;
})();
var HoverTrigger = /* #__PURE__ */ (function () {
    function HoverTrigger(value0) {
        this.value0 = value0;
    };
    HoverTrigger.create = function (value0) {
        return new HoverTrigger(value0);
    };
    return HoverTrigger;
})();
var BrushTrigger = /* #__PURE__ */ (function () {
    function BrushTrigger(value0) {
        this.value0 = value0;
    };
    BrushTrigger.create = function (value0) {
        return new BrushTrigger(value0);
    };
    return BrushTrigger;
})();
var SelectionTrigger = /* #__PURE__ */ (function () {
    function SelectionTrigger(value0) {
        this.value0 = value0;
    };
    SelectionTrigger.create = function (value0) {
        return new SelectionTrigger(value0);
    };
    return SelectionTrigger;
})();
var FocusTrigger = /* #__PURE__ */ (function () {
    function FocusTrigger(value0) {
        this.value0 = value0;
    };
    FocusTrigger.create = function (value0) {
        return new FocusTrigger(value0);
    };
    return FocusTrigger;
})();
var ClearTrigger = /* #__PURE__ */ (function () {
    function ClearTrigger() {

    };
    ClearTrigger.value = new ClearTrigger();
    return ClearTrigger;
})();
var showInteractionTrigger = {
    show: function (v) {
        if (v instanceof HoverTrigger) {
            return "HoverTrigger " + show(v.value0);
        };
        if (v instanceof BrushTrigger) {
            return "BrushTrigger {" + (show1(v.value0.x0) + ("," + (show1(v.value0.y0) + (" \u2192 " + (show1(v.value0.x1) + ("," + (show1(v.value0.y1) + "}")))))));
        };
        if (v instanceof SelectionTrigger) {
            return "SelectionTrigger " + (show2(Data_Set.size(v.value0)) + " items");
        };
        if (v instanceof FocusTrigger) {
            return "FocusTrigger " + show3(v.value0);
        };
        if (v instanceof ClearTrigger) {
            return "ClearTrigger";
        };
        throw new Error("Failed pattern match at PSD3.Interaction.Coordinated (line 116, column 1 - line 121, column 37): " + [ v.constructor.name ]);
    }
};
var showInteractionState = {
    show: function (v) {
        if (v instanceof Primary) {
            return "Primary";
        };
        if (v instanceof Related) {
            return "Related";
        };
        if (v instanceof Selected) {
            return "Selected";
        };
        if (v instanceof Dimmed) {
            return "Dimmed";
        };
        if (v instanceof Neutral) {
            return "Neutral";
        };
        throw new Error("Failed pattern match at PSD3.Interaction.Coordinated (line 145, column 1 - line 150, column 27): " + [ v.constructor.name ]);
    }
};
var eqInteractionTrigger = {
    eq: function (x) {
        return function (y) {
            if (x instanceof HoverTrigger && y instanceof HoverTrigger) {
                return x.value0 === y.value0;
            };
            if (x instanceof BrushTrigger && y instanceof BrushTrigger) {
                return x.value0.x0 === y.value0.x0 && x.value0.x1 === y.value0.x1 && x.value0.y0 === y.value0.y0 && x.value0.y1 === y.value0.y1;
            };
            if (x instanceof SelectionTrigger && y instanceof SelectionTrigger) {
                return eq2(x.value0)(y.value0);
            };
            if (x instanceof FocusTrigger && y instanceof FocusTrigger) {
                return eq3(x.value0)(y.value0);
            };
            if (x instanceof ClearTrigger && y instanceof ClearTrigger) {
                return true;
            };
            return false;
        };
    }
};
var eqInteractionState = {
    eq: function (x) {
        return function (y) {
            if (x instanceof Primary && y instanceof Primary) {
                return true;
            };
            if (x instanceof Related && y instanceof Related) {
                return true;
            };
            if (x instanceof Selected && y instanceof Selected) {
                return true;
            };
            if (x instanceof Dimmed && y instanceof Dimmed) {
                return true;
            };
            if (x instanceof Neutral && y instanceof Neutral) {
                return true;
            };
            return false;
        };
    }
};
var ordInteractionState = {
    compare: function (x) {
        return function (y) {
            if (x instanceof Primary && y instanceof Primary) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof Primary) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof Primary) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof Related && y instanceof Related) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof Related) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof Related) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof Selected && y instanceof Selected) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof Selected) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof Selected) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof Dimmed && y instanceof Dimmed) {
                return Data_Ordering.EQ.value;
            };
            if (x instanceof Dimmed) {
                return Data_Ordering.LT.value;
            };
            if (y instanceof Dimmed) {
                return Data_Ordering.GT.value;
            };
            if (x instanceof Neutral && y instanceof Neutral) {
                return Data_Ordering.EQ.value;
            };
            throw new Error("Failed pattern match at PSD3.Interaction.Coordinated (line 0, column 0 - line 0, column 0): " + [ x.constructor.name, y.constructor.name ]);
        };
    },
    Eq0: function () {
        return eqInteractionState;
    }
};
var withSelection = function (config) {
    return {
        identify: config.identify,
        group: config.group,
        position: config.position,
        respond: function (trigger) {
            return function (datum) {
                if (trigger instanceof SelectionTrigger) {
                    var $66 = member(config.identify(datum))(trigger.value0);
                    if ($66) {
                        return Selected.value;
                    };
                    return config.respond(trigger)(datum);
                };
                return config.respond(trigger)(datum);
            };
        }
    };
};
var stateToInt = function (v) {
    if (v instanceof Primary) {
        return 0;
    };
    if (v instanceof Related) {
        return 1;
    };
    if (v instanceof Selected) {
        return 2;
    };
    if (v instanceof Dimmed) {
        return 3;
    };
    if (v instanceof Neutral) {
        return 4;
    };
    throw new Error("Failed pattern match at PSD3.Interaction.Coordinated (line 258, column 1 - line 258, column 38): " + [ v.constructor.name ]);
};
var simpleHover = function (identify) {
    return {
        identify: identify,
        respond: function (trigger) {
            return function (datum) {
                if (trigger instanceof HoverTrigger) {
                    var $70 = identify(datum) === trigger.value0;
                    if ($70) {
                        return Primary.value;
                    };
                    return Dimmed.value;
                };
                if (trigger instanceof ClearTrigger) {
                    return Neutral.value;
                };
                return Neutral.value;
            };
        },
        group: Data_Maybe.Nothing.value,
        position: Data_Maybe.Nothing.value
    };
};
var registerCoordinated = function (element) {
    return function (config) {
        return $foreign.registerCoordinated_(element)(config.identify)(function (trigger) {
            return function (datum) {
                return stateToInt(config.respond(trigger)(datum));
            };
        })(Data_Nullable.toNullable(config.group));
    };
};
var pointInBox = function (v) {
    return function (v1) {
        return v.x >= v1.x0 && (v.x <= v1.x1 && (v.y >= v1.y0 && v.y <= v1.y1));
    };
};
var withBrush = function (getPos) {
    return function (config) {
        return {
            identify: config.identify,
            group: config.group,
            position: new Data_Maybe.Just(getPos),
            respond: function (trigger) {
                return function (datum) {
                    if (trigger instanceof BrushTrigger) {
                        var pos = getPos(datum);
                        var $81 = pointInBox(pos)(trigger.value0);
                        if ($81) {
                            return Selected.value;
                        };
                        return config.respond(trigger)(datum);
                    };
                    return config.respond(trigger)(datum);
                };
            }
        };
    };
};
var mkHoverTrigger = $foreign.mkHoverTrigger_;
var mkFocusTrigger = function ($85) {
    return $foreign.mkFocusTrigger_(Data_Nullable.toNullable($85));
};
var mkClearTrigger = $foreign.mkClearTrigger_;
var mkBrushTrigger = $foreign.mkBrushTrigger_;
var isSelected = function (v) {
    if (v instanceof Selected) {
        return true;
    };
    if (v instanceof Primary) {
        return true;
    };
    return false;
};
var isHighlighted = function (v) {
    if (v instanceof Primary) {
        return true;
    };
    if (v instanceof Related) {
        return true;
    };
    return false;
};
var emptyBox = {
    x0: 0.0,
    y0: 0.0,
    x1: 0.0,
    y1: 0.0
};
var emitTrigger = function (group) {
    return function (trigger) {
        return $foreign.emitTrigger_(Data_Nullable.toNullable(group))(trigger);
    };
};
var clearInteractions = function (group) {
    return $foreign.clearInteractions_(Data_Nullable.toNullable(group));
};
var boxesOverlap = function (a) {
    return function (b) {
        return a.x0 <= b.x1 && (a.x1 >= b.x0 && (a.y0 <= b.y1 && a.y1 >= b.y0));
    };
};
export {
    HoverTrigger,
    BrushTrigger,
    SelectionTrigger,
    FocusTrigger,
    ClearTrigger,
    emptyBox,
    Primary,
    Related,
    Selected,
    Dimmed,
    Neutral,
    isHighlighted,
    isSelected,
    simpleHover,
    withBrush,
    withSelection,
    registerCoordinated,
    emitTrigger,
    clearInteractions,
    mkHoverTrigger,
    mkBrushTrigger,
    mkClearTrigger,
    mkFocusTrigger,
    pointInBox,
    boxesOverlap,
    eqInteractionTrigger,
    showInteractionTrigger,
    eqInteractionState,
    ordInteractionState,
    showInteractionState
};
//# sourceMappingURL=index.js.map
