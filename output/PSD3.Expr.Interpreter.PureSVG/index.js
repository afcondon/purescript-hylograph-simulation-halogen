// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Semigroup from "../Data.Semigroup/index.js";
import * as Data_Show from "../Data.Show/index.js";
var append = /* #__PURE__ */ Data_Semigroup.append(Data_Semigroup.semigroupArray);
var foldl = /* #__PURE__ */ Data_Foldable.foldl(Data_Foldable.foldableArray);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var Element = /* #__PURE__ */ (function () {
    function Element(value0) {
        this.value0 = value0;
    };
    Element.create = function (value0) {
        return new Element(value0);
    };
    return Element;
})();
var TextContent = /* #__PURE__ */ (function () {
    function TextContent(value0) {
        this.value0 = value0;
    };
    TextContent.create = function (value0) {
        return new TextContent(value0);
    };
    return TextContent;
})();
var text = function (v) {
    return function (extraAttrs) {
        return function (content) {
            return new Element({
                tag: "text",
                attrs: append([ {
                    name: "x",
                    value: v.x
                }, {
                    name: "y",
                    value: v.y
                } ])(extraAttrs),
                children: [ new TextContent(content) ]
            });
        };
    };
};
var svg = function (w) {
    return function (h) {
        return function (children) {
            return {
                width: w,
                height: h,
                viewBox: Data_Maybe.Nothing.value,
                children: children
            };
        };
    };
};
var rect = function (v) {
    return function (extraAttrs) {
        return new Element({
            tag: "rect",
            attrs: append([ {
                name: "x",
                value: v.x
            }, {
                name: "y",
                value: v.y
            }, {
                name: "width",
                value: v.width
            }, {
                name: "height",
                value: v.height
            } ])(extraAttrs),
            children: [  ]
        });
    };
};
var path = function (d) {
    return function (extraAttrs) {
        return new Element({
            tag: "path",
            attrs: append([ {
                name: "d",
                value: d
            } ])(extraAttrs),
            children: [  ]
        });
    };
};
var line = function (v) {
    return function (extraAttrs) {
        return new Element({
            tag: "line",
            attrs: append([ {
                name: "x1",
                value: v.x1
            }, {
                name: "y1",
                value: v.y1
            }, {
                name: "x2",
                value: v.x2
            }, {
                name: "y2",
                value: v.y2
            } ])(extraAttrs),
            children: [  ]
        });
    };
};
var g = function (attrs) {
    return function (children) {
        return new Element({
            tag: "g",
            attrs: attrs,
            children: children
        });
    };
};
var forData = function (arr) {
    return function (f) {
        return Data_Array.mapWithIndex(function (i) {
            return function (a) {
                return f(a)(i);
            };
        })(arr);
    };
};
var escapeXml = function (s) {
    return s;
};
var render = function (v) {
    if (v instanceof TextContent) {
        return escapeXml(v.value0);
    };
    if (v instanceof Element) {
        var childStr = foldl(function (acc) {
            return function (child) {
                return acc + render(child);
            };
        })("")(v.value0.children);
        var attrStr = foldl(function (acc) {
            return function (v1) {
                return acc + (" " + (v1.name + ("=\"" + (escapeXml(v1.value) + "\""))));
            };
        })("")(v.value0.attrs);
        var $33 = childStr === "";
        if ($33) {
            return "<" + (v.value0.tag + (attrStr + " />"));
        };
        return "<" + (v.value0.tag + (attrStr + (">" + (childStr + ("</" + (v.value0.tag + ">"))))));
    };
    throw new Error("Failed pattern match at PSD3.Expr.Interpreter.PureSVG (line 159, column 10 - line 169, column 76): " + [ v.constructor.name ]);
};
var renderDoc = function (doc) {
    var viewBoxAttr = (function () {
        if (doc.viewBox instanceof Data_Maybe.Just) {
            return " viewBox=\"" + (doc.viewBox.value0 + "\"");
        };
        if (doc.viewBox instanceof Data_Maybe.Nothing) {
            return "";
        };
        throw new Error("Failed pattern match at PSD3.Expr.Interpreter.PureSVG (line 175, column 19 - line 177, column 20): " + [ doc.viewBox.constructor.name ]);
    })();
    var childStr = foldl(function (acc) {
        return function (child) {
            return acc + ("\x0a  " + render(child));
        };
    })("")(doc.children);
    return "<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"" + (show(doc.width) + ("\" height=\"" + (show(doc.height) + ("\"" + (viewBoxAttr + (">" + (childStr + "\x0a</svg>")))))));
};
var circle = function (v) {
    return function (extraAttrs) {
        return new Element({
            tag: "circle",
            attrs: append([ {
                name: "cx",
                value: v.cx
            }, {
                name: "cy",
                value: v.cy
            }, {
                name: "r",
                value: v.r
            } ])(extraAttrs),
            children: [  ]
        });
    };
};
export {
    Element,
    TextContent,
    svg,
    g,
    circle,
    rect,
    line,
    text,
    path,
    render,
    renderDoc,
    forData
};
//# sourceMappingURL=index.js.map
