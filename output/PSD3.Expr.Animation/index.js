// Generated by purs version 0.15.15
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Apply from "../Control.Apply/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as PSD3_Expr_Interpreter_Eval from "../PSD3.Expr.Interpreter.Eval/index.js";
import * as PSD3_Internal_Attribute from "../PSD3.Internal.Attribute/index.js";
var apply = /* #__PURE__ */ Control_Apply.apply(Data_Maybe.applyMaybe);
var map = /* #__PURE__ */ Data_Functor.map(Data_Maybe.functorMaybe);
var pure = /* #__PURE__ */ Control_Applicative.pure(Data_Maybe.applicativeMaybe);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var withStagger = function (staggerMs) {
    return function (builder) {
        var toIndexed = function (v) {
            return function (v1) {
                if (v instanceof PSD3_Internal_Attribute.StaticAnimValue) {
                    return new PSD3_Internal_Attribute.StaticAnimValue(v.value0);
                };
                if (v instanceof PSD3_Internal_Attribute.DataAnimValue) {
                    return new PSD3_Internal_Attribute.DataAnimValue(v.value0);
                };
                if (v instanceof PSD3_Internal_Attribute.IndexedAnimValue) {
                    return new PSD3_Internal_Attribute.IndexedAnimValue(v.value0);
                };
                throw new Error("Failed pattern match at PSD3.Expr.Animation (line 211, column 5 - line 211, column 70): " + [ v.constructor.name, v1.constructor.name ]);
            };
        };
        return {
            name: builder.name,
            config: builder.config,
            toValue: toIndexed(builder.toValue)(staggerMs),
            fromValue: apply(map(toIndexed)(builder.fromValue))(pure(staggerMs))
        };
    };
};
var withEasing = function (easing) {
    return function (builder) {
        return {
            name: builder.name,
            fromValue: builder.fromValue,
            toValue: builder.toValue,
            config: {
                duration: builder.config.duration,
                delay: builder.config.delay,
                easing: easing
            }
        };
    };
};
var withDuration = function (ms) {
    return function (builder) {
        return {
            name: builder.name,
            fromValue: builder.fromValue,
            toValue: builder.toValue,
            config: {
                easing: builder.config.easing,
                delay: builder.config.delay,
                duration: ms
            }
        };
    };
};
var withDelay = function (ms) {
    return function (builder) {
        return {
            name: builder.name,
            fromValue: builder.fromValue,
            toValue: builder.toValue,
            config: {
                duration: builder.config.duration,
                easing: builder.config.easing,
                delay: ms
            }
        };
    };
};
var shrinkTo = function (endRadius) {
    return new PSD3_Internal_Attribute.AnimatedAttr({
        name: "r",
        fromValue: Data_Maybe.Nothing.value,
        toValue: new PSD3_Internal_Attribute.StaticAnimValue(endRadius),
        config: PSD3_Internal_Attribute.defaultAnimationConfig
    });
};
var pathWithEasing = function (easing) {
    return function (builder) {
        return {
            fromValues: builder.fromValues,
            toValues: builder.toValues,
            generator: builder.generator,
            config: {
                duration: builder.config.duration,
                delay: builder.config.delay,
                easing: easing
            }
        };
    };
};
var pathWithDuration = function (ms) {
    return function (builder) {
        return {
            fromValues: builder.fromValues,
            toValues: builder.toValues,
            generator: builder.generator,
            config: {
                easing: builder.config.easing,
                delay: builder.config.delay,
                duration: ms
            }
        };
    };
};
var pathWithDelay = function (ms) {
    return function (builder) {
        return {
            fromValues: builder.fromValues,
            toValues: builder.toValues,
            generator: builder.generator,
            config: {
                duration: builder.config.duration,
                easing: builder.config.easing,
                delay: ms
            }
        };
    };
};
var linkVerticalGenerator = function (vals) {
    var targetY = Data_Maybe.fromMaybe(0.0)(Data_Array.index(vals)(3));
    var targetX = Data_Maybe.fromMaybe(0.0)(Data_Array.index(vals)(2));
    var sourceY = Data_Maybe.fromMaybe(0.0)(Data_Array.index(vals)(1));
    var sourceX = Data_Maybe.fromMaybe(0.0)(Data_Array.index(vals)(0));
    var midY = (sourceY + targetY) / 2.0;
    return "M" + (show(sourceX) + ("," + (show(sourceY) + (" C" + (show(sourceX) + ("," + (show(midY) + (" " + (show(targetX) + ("," + (show(midY) + (" " + (show(targetX) + ("," + show(targetY)))))))))))))));
};
var linkHorizontalGenerator = function (vals) {
    var targetY = Data_Maybe.fromMaybe(0.0)(Data_Array.index(vals)(3));
    var targetX = Data_Maybe.fromMaybe(0.0)(Data_Array.index(vals)(2));
    var sourceY = Data_Maybe.fromMaybe(0.0)(Data_Array.index(vals)(1));
    var sourceX = Data_Maybe.fromMaybe(0.0)(Data_Array.index(vals)(0));
    var midX = (sourceX + targetX) / 2.0;
    return "M" + (show(sourceX) + ("," + (show(sourceY) + (" C" + (show(midX) + ("," + (show(sourceY) + (" " + (show(midX) + ("," + (show(targetY) + (" " + (show(targetX) + ("," + show(targetY)))))))))))))));
};
var growFrom = function (startRadius) {
    return new PSD3_Internal_Attribute.AnimatedAttr({
        name: "r",
        fromValue: new Data_Maybe.Just(new PSD3_Internal_Attribute.StaticAnimValue(startRadius)),
        toValue: new PSD3_Internal_Attribute.StaticAnimValue(0.0),
        config: PSD3_Internal_Attribute.defaultAnimationConfig
    });
};
var fadeOut = /* #__PURE__ */ (function () {
    return new PSD3_Internal_Attribute.AnimatedAttr({
        name: "opacity",
        fromValue: Data_Maybe.Nothing.value,
        toValue: new PSD3_Internal_Attribute.StaticAnimValue(0.0),
        config: PSD3_Internal_Attribute.defaultAnimationConfig
    });
})();
var fadeIn = /* #__PURE__ */ (function () {
    return new PSD3_Internal_Attribute.AnimatedAttr({
        name: "opacity",
        fromValue: new Data_Maybe.Just(new PSD3_Internal_Attribute.StaticAnimValue(0.0)),
        toValue: new PSD3_Internal_Attribute.StaticAnimValue(1.0),
        config: PSD3_Internal_Attribute.defaultAnimationConfig
    });
})();
var animatedToIndexed = function (name) {
    return function (toFn) {
        return {
            name: name,
            fromValue: Data_Maybe.Nothing.value,
            toValue: new PSD3_Internal_Attribute.IndexedAnimValue(toFn),
            config: PSD3_Internal_Attribute.defaultAnimationConfig
        };
    };
};
var animatedTo = function (name) {
    return function (toExpr) {
        return {
            name: name,
            fromValue: Data_Maybe.Nothing.value,
            toValue: new PSD3_Internal_Attribute.DataAnimValue(function (d) {
                return PSD3_Expr_Interpreter_Eval.runEvalD(toExpr)(d)(0);
            }),
            config: PSD3_Internal_Attribute.defaultAnimationConfig
        };
    };
};
var animatedPathAttr = function (builder) {
    return new PSD3_Internal_Attribute.AnimatedCompound({
        name: "d",
        fromValues: builder.fromValues,
        toValues: builder.toValues,
        generator: builder.generator,
        config: builder.config
    });
};
var animatedLinkVertical = function (from) {
    return function (to) {
        return {
            fromValues: [ new PSD3_Internal_Attribute.DataAnimValue(function (d) {
                return PSD3_Expr_Interpreter_Eval.runEvalD(from.fromSourceX)(d)(0);
            }), new PSD3_Internal_Attribute.DataAnimValue(function (d) {
                return PSD3_Expr_Interpreter_Eval.runEvalD(from.fromSourceY)(d)(0);
            }), new PSD3_Internal_Attribute.DataAnimValue(function (d) {
                return PSD3_Expr_Interpreter_Eval.runEvalD(from.fromTargetX)(d)(0);
            }), new PSD3_Internal_Attribute.DataAnimValue(function (d) {
                return PSD3_Expr_Interpreter_Eval.runEvalD(from.fromTargetY)(d)(0);
            }) ],
            toValues: [ new PSD3_Internal_Attribute.DataAnimValue(function (d) {
                return PSD3_Expr_Interpreter_Eval.runEvalD(to.toSourceX)(d)(0);
            }), new PSD3_Internal_Attribute.DataAnimValue(function (d) {
                return PSD3_Expr_Interpreter_Eval.runEvalD(to.toSourceY)(d)(0);
            }), new PSD3_Internal_Attribute.DataAnimValue(function (d) {
                return PSD3_Expr_Interpreter_Eval.runEvalD(to.toTargetX)(d)(0);
            }), new PSD3_Internal_Attribute.DataAnimValue(function (d) {
                return PSD3_Expr_Interpreter_Eval.runEvalD(to.toTargetY)(d)(0);
            }) ],
            generator: linkVerticalGenerator,
            config: PSD3_Internal_Attribute.defaultAnimationConfig
        };
    };
};
var animatedLinkHorizontal = function (from) {
    return function (to) {
        return {
            fromValues: [ new PSD3_Internal_Attribute.DataAnimValue(function (d) {
                return PSD3_Expr_Interpreter_Eval.runEvalD(from.fromSourceX)(d)(0);
            }), new PSD3_Internal_Attribute.DataAnimValue(function (d) {
                return PSD3_Expr_Interpreter_Eval.runEvalD(from.fromSourceY)(d)(0);
            }), new PSD3_Internal_Attribute.DataAnimValue(function (d) {
                return PSD3_Expr_Interpreter_Eval.runEvalD(from.fromTargetX)(d)(0);
            }), new PSD3_Internal_Attribute.DataAnimValue(function (d) {
                return PSD3_Expr_Interpreter_Eval.runEvalD(from.fromTargetY)(d)(0);
            }) ],
            toValues: [ new PSD3_Internal_Attribute.DataAnimValue(function (d) {
                return PSD3_Expr_Interpreter_Eval.runEvalD(to.toSourceX)(d)(0);
            }), new PSD3_Internal_Attribute.DataAnimValue(function (d) {
                return PSD3_Expr_Interpreter_Eval.runEvalD(to.toSourceY)(d)(0);
            }), new PSD3_Internal_Attribute.DataAnimValue(function (d) {
                return PSD3_Expr_Interpreter_Eval.runEvalD(to.toTargetX)(d)(0);
            }), new PSD3_Internal_Attribute.DataAnimValue(function (d) {
                return PSD3_Expr_Interpreter_Eval.runEvalD(to.toTargetY)(d)(0);
            }) ],
            generator: linkHorizontalGenerator,
            config: PSD3_Internal_Attribute.defaultAnimationConfig
        };
    };
};
var animatedFromStatic = function (n) {
    return function (builder) {
        return {
            name: builder.name,
            toValue: builder.toValue,
            config: builder.config,
            fromValue: new Data_Maybe.Just(new PSD3_Internal_Attribute.StaticAnimValue(n))
        };
    };
};
var animatedFromIndexed = function (f) {
    return function (builder) {
        return {
            name: builder.name,
            toValue: builder.toValue,
            config: builder.config,
            fromValue: new Data_Maybe.Just(new PSD3_Internal_Attribute.IndexedAnimValue(f))
        };
    };
};
var animatedFrom = function (fromExpr) {
    return function (builder) {
        return {
            name: builder.name,
            toValue: builder.toValue,
            config: builder.config,
            fromValue: new Data_Maybe.Just(new PSD3_Internal_Attribute.DataAnimValue(function (d) {
                return PSD3_Expr_Interpreter_Eval.runEvalD(fromExpr)(d)(0);
            }))
        };
    };
};
var animated = function (builder) {
    return new PSD3_Internal_Attribute.AnimatedAttr({
        name: builder.name,
        fromValue: builder.fromValue,
        toValue: builder.toValue,
        config: builder.config
    });
};
var animatedAttr = function (name) {
    return function (builder) {
        return animated({
            fromValue: builder.fromValue,
            toValue: builder.toValue,
            config: builder.config,
            name: name
        });
    };
};
export {
    animatedTo,
    animatedToIndexed,
    animatedFrom,
    animatedFromStatic,
    animatedFromIndexed,
    animatedLinkVertical,
    animatedLinkHorizontal,
    pathWithDuration,
    pathWithEasing,
    pathWithDelay,
    animatedPathAttr,
    withDuration,
    withEasing,
    withDelay,
    withStagger,
    animated,
    animatedAttr,
    fadeIn,
    fadeOut,
    growFrom,
    shrinkTo
};
export {
    BackIn,
    BackInOut,
    BackOut,
    BounceIn,
    BounceInOut,
    BounceOut,
    CircleIn,
    CircleInOut,
    CircleOut,
    CubicIn,
    CubicInOut,
    CubicOut,
    ElasticIn,
    ElasticInOut,
    ElasticOut,
    ExpIn,
    ExpInOut,
    ExpOut,
    Linear,
    QuadIn,
    QuadInOut,
    QuadOut,
    SinIn,
    SinInOut,
    SinOut
} from "../PSD3.Internal.Attribute/index.js";
//# sourceMappingURL=index.js.map
