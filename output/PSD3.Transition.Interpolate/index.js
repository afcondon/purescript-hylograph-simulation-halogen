// Generated by purs version 0.15.15
import * as Control_Alt from "../Control.Alt/index.js";
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Array_NonEmpty from "../Data.Array.NonEmpty/index.js";
import * as Data_Either from "../Data.Either/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Number from "../Data.Number/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_String_Regex from "../Data.String.Regex/index.js";
import * as Data_String_Regex_Flags from "../Data.String.Regex.Flags/index.js";
import * as PSD3_Transition_Tick from "../PSD3.Transition.Tick/index.js";
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var show1 = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var max = /* #__PURE__ */ Data_Ord.max(Data_Ord.ordNumber);
var min = /* #__PURE__ */ Data_Ord.min(Data_Ord.ordNumber);
var bind = /* #__PURE__ */ Control_Bind.bind(Data_Maybe.bindMaybe);
var join = /* #__PURE__ */ Control_Bind.join(Data_Maybe.bindMaybe);
var pure = /* #__PURE__ */ Control_Applicative.pure(Data_Maybe.applicativeMaybe);
var alt = /* #__PURE__ */ Control_Alt.alt(Data_Maybe.altMaybe);
var RGB = function (x) {
    return x;
};
var HSL = function (x) {
    return x;
};
var showRGB = {
    show: function (v) {
        return "RGB(" + (show(v.r) + ("," + (show(v.g) + ("," + (show(v.b) + ")")))));
    }
};
var showHSL = {
    show: function (v) {
        return "HSL(" + (show1(v.h) + ("," + (show1(v.s) + ("," + (show1(v.l) + ")")))));
    }
};
var interpolatableNumber = {
    interpolate: PSD3_Transition_Tick.lerp
};
var interpolatableInt = {
    interpolate: PSD3_Transition_Tick.lerpInt
};
var eqRGB = {
    eq: function (x) {
        return function (y) {
            return x.b === y.b && x.g === y.g && x.r === y.r;
        };
    }
};
var eqHSL = {
    eq: function (x) {
        return function (y) {
            return x.h === y.h && x.l === y.l && x.s === y.s;
        };
    }
};
var rgbToHSL = function (v) {
    var mod$prime = function (x) {
        return function (y) {
            return x - y * Data_Number.floor(x / y);
        };
    };
    var r$prime = Data_Int.toNumber(v.r) / 255.0;
    var g$prime = Data_Int.toNumber(v.g) / 255.0;
    var b$prime = Data_Int.toNumber(v.b) / 255.0;
    var cmax = max(r$prime)(max(g$prime)(b$prime));
    var cmin = min(r$prime)(min(g$prime)(b$prime));
    var delta = cmax - cmin;
    var l = (cmax + cmin) / 2.0;
    var s = (function () {
        var $55 = delta === 0.0;
        if ($55) {
            return 0.0;
        };
        return delta / (1.0 - Data_Number.abs(2.0 * l - 1.0));
    })();
    var h = (function () {
        var $56 = delta === 0.0;
        if ($56) {
            return 0.0;
        };
        var $57 = cmax === r$prime;
        if ($57) {
            return 60.0 * mod$prime((g$prime - b$prime) / delta)(6.0);
        };
        var $58 = cmax === g$prime;
        if ($58) {
            return 60.0 * ((b$prime - r$prime) / delta + 2.0);
        };
        return 60.0 * ((r$prime - g$prime) / delta + 4.0);
    })();
    var h$prime = (function () {
        var $59 = h < 0.0;
        if ($59) {
            return h + 360.0;
        };
        return h;
    })();
    return {
        h: h$prime,
        s: s,
        l: l
    };
};
var rgbToCSS = function (v) {
    return "rgb(" + (show(v.r) + ("," + (show(v.g) + ("," + (show(v.b) + ")")))));
};
var lerpRGB = function (v) {
    return function (v1) {
        return function (t) {
            return {
                r: PSD3_Transition_Tick.lerpInt(v.r)(v1.r)(t),
                g: PSD3_Transition_Tick.lerpInt(v.g)(v1.g)(t),
                b: PSD3_Transition_Tick.lerpInt(v.b)(v1.b)(t)
            };
        };
    };
};
var interpolatableRGB = {
    interpolate: lerpRGB
};
var lerpPointXY = function (from) {
    return function (to) {
        return function (progress) {
            return {
                x: PSD3_Transition_Tick.lerp(from.fromX)(to.toX)(progress.progressX),
                y: PSD3_Transition_Tick.lerp(from.fromY)(to.toY)(progress.progressY)
            };
        };
    };
};
var lerpPoint = function (p1) {
    return function (p2) {
        return function (t) {
            return {
                x: PSD3_Transition_Tick.lerp(p1.x)(p2.x)(t),
                y: PSD3_Transition_Tick.lerp(p1.y)(p2.y)(t)
            };
        };
    };
};
var lerpHSL = function (v) {
    return function (v1) {
        return function (t) {
            var lerpHue = function (h1) {
                return function (h2) {
                    return function (progress) {
                        var diff = h2 - h1;
                        var shortDiff = (function () {
                            var $70 = Data_Number.abs(diff) > 180.0;
                            if ($70) {
                                var $71 = diff > 0.0;
                                if ($71) {
                                    return diff - 360.0;
                                };
                                return diff + 360.0;
                            };
                            return diff;
                        })();
                        var result = h1 + shortDiff * progress;
                        var $72 = result < 0.0;
                        if ($72) {
                            return result + 360.0;
                        };
                        var $73 = result >= 360.0;
                        if ($73) {
                            return result - 360.0;
                        };
                        return result;
                    };
                };
            };
            return {
                h: lerpHue(v.h)(v1.h)(t),
                s: PSD3_Transition_Tick.lerp(v.s)(v1.s)(t),
                l: PSD3_Transition_Tick.lerp(v.l)(v1.l)(t)
            };
        };
    };
};
var interpolatableHSL = {
    interpolate: lerpHSL
};
var interpolate = function (dict) {
    return dict.interpolate;
};
var makeInterpolator = function (dictInterpolatable) {
    var interpolate1 = interpolate(dictInterpolatable);
    return function (from) {
        return function (to) {
            return interpolate1(from)(to);
        };
    };
};
var hslToRGB = function (v) {
    var mod$prime = function (a) {
        return function (b) {
            return a - b * Data_Number.floor(a / b);
        };
    };
    var c = (1.0 - Data_Number.abs(2.0 * v.l - 1.0)) * v.s;
    var m = v.l - c / 2.0;
    var x = c * (1.0 - Data_Number.abs(mod$prime(v.h / 60.0)(2.0) - 1.0));
    var v1 = (function () {
        var $76 = v.h < 60.0;
        if ($76) {
            return {
                "r'": c,
                "g'": x,
                "b'": 0.0
            };
        };
        var $77 = v.h < 120.0;
        if ($77) {
            return {
                "r'": x,
                "g'": c,
                "b'": 0.0
            };
        };
        var $78 = v.h < 180.0;
        if ($78) {
            return {
                "r'": 0.0,
                "g'": c,
                "b'": x
            };
        };
        var $79 = v.h < 240.0;
        if ($79) {
            return {
                "r'": 0.0,
                "g'": x,
                "b'": c
            };
        };
        var $80 = v.h < 300.0;
        if ($80) {
            return {
                "r'": x,
                "g'": 0.0,
                "b'": c
            };
        };
        return {
            "r'": c,
            "g'": 0.0,
            "b'": x
        };
    })();
    return {
        r: Data_Int.round((v1["r'"] + m) * 255.0),
        g: Data_Int.round((v1["g'"] + m) * 255.0),
        b: Data_Int.round((v1["b'"] + m) * 255.0)
    };
};
var hslToCSS = function (v) {
    return "hsl(" + (show(Data_Int.round(v.h)) + ("," + (show(Data_Int.round(v.s * 100.0)) + ("%," + (show(Data_Int.round(v.l * 100.0)) + "%)")))));
};
var cssToRGB = function (s) {
    var parseRGB = function (str) {
        return bind(Data_Either.hush(Data_String_Regex.regex("rgb\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)")(Data_String_Regex_Flags.noFlags)))(function (re) {
            return bind(Data_String_Regex.match(re)(str))(function (matches) {
                return bind(join(Data_Array_NonEmpty.index(matches)(1)))(function (rStr) {
                    return bind(join(Data_Array_NonEmpty.index(matches)(2)))(function (gStr) {
                        return bind(join(Data_Array_NonEmpty.index(matches)(3)))(function (bStr) {
                            return bind(Data_Number.fromString(rStr))(function (r) {
                                return bind(Data_Number.fromString(gStr))(function (g) {
                                    return bind(Data_Number.fromString(bStr))(function (b) {
                                        return pure({
                                            r: Data_Int.round(r),
                                            g: Data_Int.round(g),
                                            b: Data_Int.round(b)
                                        });
                                    });
                                });
                            });
                        });
                    });
                });
            });
        });
    };
    var parseHex = function (str) {
        return bind(Data_Either.hush(Data_String_Regex.regex("^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$")(Data_String_Regex_Flags.noFlags)))(function (re) {
            return bind(Data_String_Regex.match(re)(str))(function (matches) {
                return bind(join(Data_Array_NonEmpty.index(matches)(1)))(function (rStr) {
                    return bind(join(Data_Array_NonEmpty.index(matches)(2)))(function (gStr) {
                        return bind(join(Data_Array_NonEmpty.index(matches)(3)))(function (bStr) {
                            return bind(Data_Int.fromStringAs(Data_Int.hexadecimal)(rStr))(function (r) {
                                return bind(Data_Int.fromStringAs(Data_Int.hexadecimal)(gStr))(function (g) {
                                    return bind(Data_Int.fromStringAs(Data_Int.hexadecimal)(bStr))(function (b) {
                                        return pure({
                                            r: r,
                                            g: g,
                                            b: b
                                        });
                                    });
                                });
                            });
                        });
                    });
                });
            });
        });
    };
    return alt(parseRGB(s))(parseHex(s));
};
export {
    lerpPoint,
    lerpPointXY,
    RGB,
    lerpRGB,
    rgbToCSS,
    cssToRGB,
    HSL,
    lerpHSL,
    hslToCSS,
    hslToRGB,
    rgbToHSL,
    interpolate,
    makeInterpolator,
    eqRGB,
    showRGB,
    eqHSL,
    showHSL,
    interpolatableNumber,
    interpolatableInt,
    interpolatableRGB,
    interpolatableHSL
};
//# sourceMappingURL=index.js.map
