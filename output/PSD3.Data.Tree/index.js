// Generated by purs version 0.15.15
import * as $foreign from "./foreign.js";
import * as Control_Comonad_Cofree from "../Control.Comonad.Cofree/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Either from "../Data.Either/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Graph_Layout from "../Data.Graph.Layout/index.js";
import * as Data_List from "../Data.List/index.js";
import * as Data_List_Types from "../Data.List.Types/index.js";
import * as Data_Map_Internal from "../Data.Map.Internal/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Tree from "../Data.Tree/index.js";
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var fromFoldable = /* #__PURE__ */ Data_Array.fromFoldable(Data_List_Types.foldableList);
var lookup = /* #__PURE__ */ Data_Map_Internal.lookup(Data_Ord.ordInt);
var eq = /* #__PURE__ */ Data_Eq.eq(/* #__PURE__ */ Data_Maybe.eqMaybe(Data_Eq.eqInt));
var fromFoldable1 = /* #__PURE__ */ Data_List.fromFoldable(Data_Foldable.foldableArray);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var TidyTree = /* #__PURE__ */ (function () {
    function TidyTree() {

    };
    TidyTree.value = new TidyTree();
    return TidyTree;
})();
var Dendrogram = /* #__PURE__ */ (function () {
    function Dendrogram() {

    };
    Dendrogram.value = new Dendrogram();
    return Dendrogram;
})();
var treeToD3Tree = function (tree) {
    var data_ = Control_Comonad_Cofree.head(tree);
    var children = Control_Comonad_Cofree.tail(tree);
    if (children instanceof Data_List_Types.Nil) {
        return $foreign.idTreeLeaf_(data_);
    };
    return $foreign.idTreeParent_(data_)(map(treeToD3Tree)(fromFoldable(children)));
};
var showTreeType = {
    show: function (v) {
        if (v instanceof TidyTree) {
            return "Tidy Tree";
        };
        if (v instanceof Dendrogram) {
            return "Dendrogram";
        };
        throw new Error("Failed pattern match at PSD3.Data.Tree (line 37, column 1 - line 39, column 33): " + [ v.constructor.name ]);
    }
};
var makeD3TreeJSONFromTreeID = function (root) {
    return function (nodesMap) {
        var go = function (tree) {
            var id = Control_Comonad_Cofree.head(tree);
            var children = Control_Comonad_Cofree.tail(tree);
            var v = lookup(id)(nodesMap);
            if (v instanceof Data_Maybe.Nothing) {
                return $foreign.emptyTreeJson_;
            };
            if (v instanceof Data_Maybe.Just) {
                if (children instanceof Data_List_Types.Nil) {
                    return $foreign.idTreeLeaf_(v.value0);
                };
                return $foreign.idTreeParent_(v.value0)(map(go)(fromFoldable(children)));
            };
            throw new Error("Failed pattern match at PSD3.Data.Tree (line 73, column 10 - line 77, column 68): " + [ v.constructor.name ]);
        };
        return go(root);
    };
};
var eqTreeType = {
    eq: function (x) {
        return function (y) {
            if (x instanceof TidyTree && y instanceof TidyTree) {
                return true;
            };
            if (x instanceof Dendrogram && y instanceof Dendrogram) {
                return true;
            };
            return false;
        };
    }
};
var arrayToTree = function (config) {
    var buildSubtree = function (node) {
        var nodeId = config.getId(node);
        var children = Data_Array.filter(function (n) {
            return eq(config.getParentId(n))(new Data_Maybe.Just(nodeId));
        })(config.nodes);
        var childTrees = map(buildSubtree)(children);
        return Data_Tree.mkTree(node)(fromFoldable1(childTrees));
    };
    var roots = Data_Array.filter(function (n) {
        return eq(config.getParentId(n))(Data_Maybe.Nothing.value);
    })(config.nodes);
    var v = Data_Array.uncons(roots);
    if (v instanceof Data_Maybe.Nothing) {
        return new Data_Either.Left("No root node found (no node with parent = Nothing)");
    };
    if (v instanceof Data_Maybe.Just) {
        var $22 = Data_Array.length(v.value0.tail) > 0;
        if ($22) {
            return new Data_Either.Left("Multiple root nodes found: " + show(Data_Array.length(roots)));
        };
        return new Data_Either.Right(buildSubtree(v.value0.head));
    };
    throw new Error("Failed pattern match at PSD3.Data.Tree (line 134, column 3 - line 139, column 43): " + [ v.constructor.name ]);
};
export {
    TidyTree,
    Dendrogram,
    makeD3TreeJSONFromTreeID,
    treeToD3Tree,
    arrayToTree,
    eqTreeType,
    showTreeType
};
export {
    Horizontal,
    Radial,
    Vertical
} from "../Data.Graph.Layout/index.js";
//# sourceMappingURL=index.js.map
