// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_String_Common from "../Data.String.Common/index.js";
var shortenName = function (name) {
    var v = Data_Array.last(Data_String_Common.split(".")(name));
    if (v instanceof Data_Maybe.Just) {
        return v.value0;
    };
    if (v instanceof Data_Maybe.Nothing) {
        return name;
    };
    throw new Error("Failed pattern match at DataViz.Layout.Adjacency.Layout (line 153, column 3 - line 155, column 20): " + [ v.constructor.name ]);
};
var defaultConfig = {
    cellSize: 20.0,
    labelMargin: 8.0,
    labelWidth: 100.0,
    labelHeight: 80.0
};
var cellPosition = function (config) {
    return function (offsetX) {
        return function (offsetY) {
            return function (rowIdx) {
                return function (colIdx) {
                    return {
                        x: offsetX + Data_Int.toNumber(colIdx) * config.cellSize,
                        y: offsetY + Data_Int.toNumber(rowIdx) * config.cellSize,
                        width: config.cellSize,
                        height: config.cellSize
                    };
                };
            };
        };
    };
};
var buildRowLabels = function (config) {
    return function (gridOffsetY) {
        return function (names) {
            var buildLabel = function (idx) {
                return function (name) {
                    var y = gridOffsetY + (Data_Int.toNumber(idx) + 0.5) * config.cellSize;
                    var position = {
                        x: config.labelWidth,
                        y: y,
                        anchor: "end",
                        rotation: 0.0
                    };
                    return {
                        index: idx,
                        name: name,
                        displayName: shortenName(name),
                        isRow: true,
                        position: position
                    };
                };
            };
            return Data_Array.mapWithIndex(buildLabel)(names);
        };
    };
};
var buildColLabels = function (config) {
    return function (gridOffsetX) {
        return function (names) {
            var buildLabel = function (idx) {
                return function (name) {
                    var x = gridOffsetX + (Data_Int.toNumber(idx) + 0.5) * config.cellSize;
                    var position = {
                        x: x,
                        y: config.labelHeight,
                        anchor: "start",
                        rotation: -45.0
                    };
                    return {
                        index: idx,
                        name: name,
                        displayName: shortenName(name),
                        isRow: false,
                        position: position
                    };
                };
            };
            return Data_Array.mapWithIndex(buildLabel)(names);
        };
    };
};
var buildCells = function (config) {
    return function (offsetX) {
        return function (offsetY) {
            return function (matrix) {
                return function (names) {
                    var buildCell = function (rowIdx) {
                        return function (colIdx) {
                            return function (value) {
                                var rowName = Data_Maybe.fromMaybe("")(Data_Array.index(names)(rowIdx));
                                var position = cellPosition(config)(offsetX)(offsetY)(rowIdx)(colIdx);
                                var colName = Data_Maybe.fromMaybe("")(Data_Array.index(names)(colIdx));
                                return {
                                    row: rowIdx,
                                    col: colIdx,
                                    value: value,
                                    rowName: rowName,
                                    colName: colName,
                                    position: position
                                };
                            };
                        };
                    };
                    var buildRow = function (rowIdx) {
                        return function (row) {
                            return Data_Array.mapWithIndex(buildCell(rowIdx))(row);
                        };
                    };
                    return Data_Array.concat(Data_Array.mapWithIndex(buildRow)(matrix));
                };
            };
        };
    };
};
var layoutWithConfig = function (config) {
    return function (v) {
        var n = Data_Array.length(v.names);
        var gridWidth = config.cellSize * Data_Int.toNumber(n);
        var totalWidth = config.labelWidth + config.labelMargin + gridWidth;
        var gridOffsetY = config.labelHeight + config.labelMargin;
        var rowLabels = buildRowLabels(config)(gridOffsetY)(v.names);
        var gridOffsetX = config.labelWidth + config.labelMargin;
        var gridHeight = config.cellSize * Data_Int.toNumber(n);
        var totalHeight = config.labelHeight + config.labelMargin + gridHeight;
        var colLabels = buildColLabels(config)(gridOffsetX)(v.names);
        var cells = buildCells(config)(gridOffsetX)(gridOffsetY)(v.matrix)(v.names);
        return {
            cells: cells,
            rowLabels: rowLabels,
            colLabels: colLabels,
            gridWidth: gridWidth,
            gridHeight: gridHeight,
            totalWidth: totalWidth,
            totalHeight: totalHeight
        };
    };
};
var layout = /* #__PURE__ */ layoutWithConfig(defaultConfig);
export {
    layout,
    layoutWithConfig,
    defaultConfig,
    shortenName
};
//# sourceMappingURL=index.js.map
