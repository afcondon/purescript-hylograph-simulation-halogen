// Generated by purs version 0.15.15
import * as $foreign from "./foreign.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Nullable from "../Data.Nullable/index.js";
import * as Data_Traversable from "../Data.Traversable/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Effect from "../Effect/index.js";
import * as Effect_Class from "../Effect.Class/index.js";
import * as PSD3_Internal_Selection_Operations_Helpers from "../PSD3.Internal.Selection.Operations.Helpers/index.js";
import * as PSD3_Internal_Selection_Types from "../PSD3.Internal.Selection.Types/index.js";
import * as Web_DOM_ParentNode from "../Web.DOM.ParentNode/index.js";
import * as Web_HTML from "../Web.HTML/index.js";
import * as Web_HTML_HTMLDocument from "../Web.HTML.HTMLDocument/index.js";
import * as Web_HTML_Window from "../Web.HTML.Window/index.js";
var bind = /* #__PURE__ */ Control_Bind.bind(Effect.bindEffect);
var traverse = /* #__PURE__ */ Data_Traversable.traverse(Data_Traversable.traversableArray)(Effect.applicativeEffect);
var selectElement = function (dictMonadEffect) {
    var liftEffect = Effect_Class.liftEffect(dictMonadEffect);
    return function (element) {
        return liftEffect(function __do() {
            var htmlDoc = bind(Web_HTML.window)(Web_HTML_Window.document)();
            var doc = Web_HTML_HTMLDocument.toDocument(htmlDoc);
            return new PSD3_Internal_Selection_Types.EmptySelection({
                parentElements: [ element ],
                document: doc
            });
        });
    };
};
var selectAllWithData = function (dictMonadEffect) {
    var liftEffect = Effect_Class.liftEffect(dictMonadEffect);
    return function (selector) {
        return function (v) {
            return liftEffect(function __do() {
                var doc = PSD3_Internal_Selection_Operations_Helpers.getDocument(v)();
                var elements = (function () {
                    if (v instanceof PSD3_Internal_Selection_Types.EmptySelection) {
                        return PSD3_Internal_Selection_Operations_Helpers.querySelectorAllElements(selector)(v.value0.parentElements)();
                    };
                    if (v instanceof PSD3_Internal_Selection_Types.BoundSelection) {
                        return PSD3_Internal_Selection_Operations_Helpers.querySelectorAllElements(selector)(v.value0.elements)();
                    };
                    if (v instanceof PSD3_Internal_Selection_Types.PendingSelection) {
                        return PSD3_Internal_Selection_Operations_Helpers.querySelectorAllElements(selector)(v.value0.parentElements)();
                    };
                    if (v instanceof PSD3_Internal_Selection_Types.ExitingSelection) {
                        return PSD3_Internal_Selection_Operations_Helpers.querySelectorAllElements(selector)(v.value0.elements)();
                    };
                    throw new Error("Failed pattern match at PSD3.Internal.Selection.Operations.Selection (line 148, column 15 - line 156, column 50): " + [ v.constructor.name ]);
                })();
                var dataArray = traverse(function (el) {
                    return function __do() {
                        var nullableDatum = $foreign.getElementData_(el)();
                        var v1 = Data_Nullable.toMaybe(nullableDatum);
                        if (v1 instanceof Data_Maybe.Just) {
                            return v1.value0;
                        };
                        if (v1 instanceof Data_Maybe.Nothing) {
                            return Data_Unit.unit;
                        };
                        throw new Error("Failed pattern match at PSD3.Internal.Selection.Operations.Selection (line 162, column 16 - line 164, column 39): " + [ v1.constructor.name ]);
                    };
                })(elements)();
                return PSD3_Internal_Selection_Types.mkBoundSelection(elements)(dataArray)(Data_Maybe.Nothing.value)(doc);
            });
        };
    };
};
var selectAll = function (dictMonadEffect) {
    var liftEffect = Effect_Class.liftEffect(dictMonadEffect);
    return function (v) {
        return function (v1) {
            return liftEffect(function __do() {
                var doc = PSD3_Internal_Selection_Operations_Helpers.getDocument(v1)();
                var parentElems = (function () {
                    if (v1 instanceof PSD3_Internal_Selection_Types.EmptySelection) {
                        return v1.value0.parentElements;
                    };
                    if (v1 instanceof PSD3_Internal_Selection_Types.BoundSelection) {
                        return v1.value0.elements;
                    };
                    if (v1 instanceof PSD3_Internal_Selection_Types.PendingSelection) {
                        return v1.value0.parentElements;
                    };
                    if (v1 instanceof PSD3_Internal_Selection_Types.ExitingSelection) {
                        return v1.value0.elements;
                    };
                    throw new Error("Failed pattern match at PSD3.Internal.Selection.Operations.Selection (line 116, column 19 - line 120, column 48): " + [ v1.constructor.name ]);
                })();
                return new PSD3_Internal_Selection_Types.EmptySelection({
                    parentElements: parentElems,
                    document: doc
                });
            });
        };
    };
};
var select = function (dictMonadEffect) {
    var liftEffect = Effect_Class.liftEffect(dictMonadEffect);
    return function (selector) {
        return liftEffect(function __do() {
            var htmlDoc = bind(Web_HTML.window)(Web_HTML_Window.document)();
            var doc = Web_HTML_HTMLDocument.toDocument(htmlDoc);
            var parentNode = Web_HTML_HTMLDocument.toParentNode(htmlDoc);
            var maybeElement = Web_DOM_ParentNode.querySelector(selector)(parentNode)();
            if (maybeElement instanceof Data_Maybe.Nothing) {
                return new PSD3_Internal_Selection_Types.EmptySelection({
                    parentElements: [  ],
                    document: doc
                });
            };
            if (maybeElement instanceof Data_Maybe.Just) {
                return new PSD3_Internal_Selection_Types.EmptySelection({
                    parentElements: [ maybeElement.value0 ],
                    document: doc
                });
            };
            throw new Error("Failed pattern match at PSD3.Internal.Selection.Operations.Selection (line 62, column 3 - line 70, column 8): " + [ maybeElement.constructor.name ]);
        });
    };
};
export {
    select,
    selectElement,
    selectAll,
    selectAllWithData
};
//# sourceMappingURL=index.js.map
