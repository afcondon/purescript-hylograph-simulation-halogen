// Generated by purs version 0.15.15
import * as Control_Alt from "../Control.Alt/index.js";
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Control_Comonad_Cofree from "../Control.Comonad.Cofree/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_List from "../Data.List/index.js";
import * as Data_List_Types from "../Data.List.Types/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Semigroup from "../Data.Semigroup/index.js";
import * as Data_Tree from "../Data.Tree/index.js";
var append = /* #__PURE__ */ Data_Semigroup.append(Data_List_Types.semigroupList);
var eqRec = /* #__PURE__ */ Data_Eq.eqRec();
var eqRowCons = /* #__PURE__ */ Data_Eq.eqRowCons(Data_Eq.eqRowNil)()({
    reflectSymbol: function () {
        return "parents";
    }
});
var nodeIsSymbol = {
    reflectSymbol: function () {
        return "node";
    }
};
var eqCofree = /* #__PURE__ */ Control_Comonad_Cofree.eqCofree(Data_List_Types.eq1List);
var beforeIsSymbol = {
    reflectSymbol: function () {
        return "before";
    }
};
var afterIsSymbol = {
    reflectSymbol: function () {
        return "after";
    }
};
var bind = /* #__PURE__ */ Control_Bind.bind(Data_Maybe.bindMaybe);
var alt = /* #__PURE__ */ Control_Alt.alt(Data_Maybe.altMaybe);
var pure = /* #__PURE__ */ Control_Applicative.pure(Data_Maybe.applicativeMaybe);
var Loc = function (x) {
    return x;
};
var siblings = function (v) {
    return append(Data_List.reverse(v.before))(new Data_List_Types.Cons(v.node, v.after));
};
var setNode = function (a) {
    return function (v) {
        return {
            before: v.before,
            after: v.after,
            parents: v.parents,
            node: a
        };
    };
};
var prev = function (v) {
    if (v.before instanceof Data_List_Types.Nil) {
        return Data_Maybe.Nothing.value;
    };
    if (v.before instanceof Data_List_Types.Cons) {
        return new Data_Maybe.Just({
            parents: v.parents,
            node: v.before.value0,
            before: v.before.value1,
            after: new Data_List_Types.Cons(v.node, v.after)
        });
    };
    throw new Error("Failed pattern match at Data.Tree.Zipper (line 45, column 3 - line 51, column 8): " + [ v.before.constructor.name ]);
};
var parents = function (v) {
    return v.parents;
};
var node = function (v) {
    return v.node;
};
var setValue = function (a) {
    return function (l) {
        return setNode(Data_Tree.setNodeValue(a)(node(l)))(l);
    };
};
var value = function ($129) {
    return Control_Comonad_Cofree.head(node($129));
};
var next = function (v) {
    if (v.after instanceof Data_List_Types.Nil) {
        return Data_Maybe.Nothing.value;
    };
    if (v.after instanceof Data_List_Types.Cons) {
        return new Data_Maybe.Just({
            parents: v.parents,
            node: v.after.value0,
            before: new Data_List_Types.Cons(v.node, v.before),
            after: v.after.value1
        });
    };
    throw new Error("Failed pattern match at Data.Tree.Zipper (line 34, column 3 - line 40, column 8): " + [ v.after.constructor.name ]);
};
var modifyValue = function (f) {
    return function (l) {
        return setNode(Data_Tree.modifyNodeValue(f)(node(l)))(l);
    };
};
var modifyNode = function (f) {
    return function (v) {
        return {
            before: v.before,
            after: v.after,
            parents: v.parents,
            node: f(v.node)
        };
    };
};
var last = function (v) {
    var v1 = Data_List.reverse(v.after);
    if (v1 instanceof Data_List_Types.Nil) {
        return v;
    };
    if (v1 instanceof Data_List_Types.Cons) {
        return {
            parents: v.parents,
            node: v1.value0,
            before: append(v1.value1)(new Data_List_Types.Cons(v.node, v.before)),
            after: Data_List_Types.Nil.value
        };
    };
    throw new Error("Failed pattern match at Data.Tree.Zipper (line 67, column 3 - line 73, column 8): " + [ v1.constructor.name ]);
};
var insertBefore = function (n) {
    return function (v) {
        return {
            before: v.before,
            parents: v.parents,
            node: n,
            after: new Data_List_Types.Cons(v.node, v.after)
        };
    };
};
var insertAfter = function (n) {
    return function (v) {
        return {
            after: v.after,
            parents: v.parents,
            node: n,
            before: new Data_List_Types.Cons(v.node, v.before)
        };
    };
};
var fromTree = function (n) {
    return {
        node: n,
        before: Data_List_Types.Nil.value,
        after: Data_List_Types.Nil.value,
        parents: Data_List_Types.Nil.value
    };
};
var first = function (v) {
    var v1 = Data_List.reverse(v.before);
    if (v1 instanceof Data_List_Types.Nil) {
        return v;
    };
    if (v1 instanceof Data_List_Types.Cons) {
        return {
            parents: v.parents,
            node: v1.value0,
            before: Data_List_Types.Nil.value,
            after: append(v1.value1)(v.after)
        };
    };
    throw new Error("Failed pattern match at Data.Tree.Zipper (line 56, column 3 - line 62, column 8): " + [ v1.constructor.name ]);
};
var eqLoc = function (dictEq) {
    var eqCofree1 = eqCofree(dictEq);
    var eqList = Data_List_Types.eqList(eqCofree1);
    return eqRec(Data_Eq.eqRowCons(Data_Eq.eqRowCons(Data_Eq.eqRowCons(eqRowCons(Data_List_Types.eqList(eqLoc(dictEq))))()(nodeIsSymbol)(eqCofree1))()(beforeIsSymbol)(eqList))()(afterIsSymbol)(eqList));
};
var children = function ($130) {
    return Control_Comonad_Cofree.tail(node($130));
};
var firstChild = function (n) {
    var v = children(n);
    if (v instanceof Data_List_Types.Nil) {
        return Data_Maybe.Nothing.value;
    };
    if (v instanceof Data_List_Types.Cons) {
        return new Data_Maybe.Just({
            node: v.value0,
            before: Data_List_Types.Nil.value,
            after: v.value1,
            parents: new Data_List_Types.Cons(n, parents(n))
        });
    };
    throw new Error("Failed pattern match at Data.Tree.Zipper (line 97, column 3 - line 105, column 10): " + [ v.constructor.name ]);
};
var down = firstChild;
var findDownWhere = function (v) {
    return function (v1) {
        if (v(value(v1))) {
            return new Data_Maybe.Just(v1);
        };
        var lookNext = bind(next(v1))(findDownWhere(v));
        var lookDown = bind(down(v1))(findDownWhere(v));
        return alt(lookNext)(lookDown);
    };
};
var findDown = function (dictEq) {
    var eq = Data_Eq.eq(dictEq);
    return function (a) {
        return findDownWhere(function (v) {
            return eq(v)(a);
        });
    };
};
var flattenLocDepthFirst = function (loc) {
    var goDir = function (loc$prime) {
        return function (dirFn) {
            var v = dirFn(loc$prime);
            if (v instanceof Data_Maybe.Just) {
                return new Data_List_Types.Cons(v.value0, go(v.value0));
            };
            if (v instanceof Data_Maybe.Nothing) {
                return Data_List_Types.Nil.value;
            };
            throw new Error("Failed pattern match at Data.Tree.Zipper (line 273, column 22 - line 275, column 19): " + [ v.constructor.name ]);
        };
    };
    var go = function (loc$prime) {
        var nexts = goDir(loc$prime)(next);
        var downs = goDir(loc$prime)(down);
        return append(downs)(nexts);
    };
    return new Data_List_Types.Cons(loc, go(loc));
};
var insertChild = function (n) {
    return function (l) {
        var v = down(l);
        if (v instanceof Data_Maybe.Just) {
            return insertAfter(n)(v.value0);
        };
        if (v instanceof Data_Maybe.Nothing) {
            return {
                node: n,
                after: Data_List_Types.Nil.value,
                before: Data_List_Types.Nil.value,
                parents: new Data_List_Types.Cons(l, parents(l))
            };
        };
        throw new Error("Failed pattern match at Data.Tree.Zipper (line 191, column 3 - line 198, column 8): " + [ v.constructor.name ]);
    };
};
var lastChild = function (n) {
    var v = Data_List.reverse(children(n));
    if (v instanceof Data_List_Types.Nil) {
        return Data_Maybe.Nothing.value;
    };
    if (v instanceof Data_List_Types.Cons) {
        return new Data_Maybe.Just({
            node: v.value0,
            before: v.value1,
            after: Data_List_Types.Nil.value,
            parents: new Data_List_Types.Cons(n, parents(n))
        });
    };
    throw new Error("Failed pattern match at Data.Tree.Zipper (line 114, column 3 - line 122, column 10): " + [ v.constructor.name ]);
};
var before = function (v) {
    return v.before;
};
var after = function (v) {
    return v.after;
};
var $$delete = function (v) {
    if (v.after instanceof Data_List_Types.Cons) {
        return {
            before: v.before,
            parents: v.parents,
            node: v.after.value0,
            after: v.after.value1
        };
    };
    if (v.after instanceof Data_List_Types.Nil) {
        if (v.before instanceof Data_List_Types.Cons) {
            return {
                after: v.after,
                parents: v.parents,
                node: v.before.value0,
                before: v.before.value1
            };
        };
        if (v.before instanceof Data_List_Types.Nil) {
            if (v.parents instanceof Data_List_Types.Nil) {
                return v;
            };
            if (v.parents instanceof Data_List_Types.Cons) {
                return {
                    node: Data_Tree.mkTree(value(v.parents.value0))(Data_List_Types.Nil.value),
                    before: before(v.parents.value0),
                    after: after(v.parents.value0),
                    parents: parents(v.parents.value0)
                };
            };
            throw new Error("Failed pattern match at Data.Tree.Zipper (line 215, column 11 - line 222, column 16): " + [ v.parents.constructor.name ]);
        };
        throw new Error("Failed pattern match at Data.Tree.Zipper (line 209, column 7 - line 222, column 16): " + [ v.before.constructor.name ]);
    };
    throw new Error("Failed pattern match at Data.Tree.Zipper (line 203, column 3 - line 222, column 16): " + [ v.after.constructor.name ]);
};
var up = function (v) {
    if (v.parents instanceof Data_List_Types.Nil) {
        return Data_Maybe.Nothing.value;
    };
    if (v.parents instanceof Data_List_Types.Cons) {
        return new Data_Maybe.Just({
            node: Control_Comonad_Cofree.mkCofree(value(v.parents.value0))(siblings(v)),
            before: before(v.parents.value0),
            after: after(v.parents.value0),
            parents: v.parents.value1
        });
    };
    throw new Error("Failed pattern match at Data.Tree.Zipper (line 78, column 3 - line 85, column 8): " + [ v.parents.constructor.name ]);
};
var findUpWhere = function (v) {
    return function (v1) {
        if (v(value(v1))) {
            return new Data_Maybe.Just(v1);
        };
        var lookUp = bind(up(v1))(findUpWhere(v));
        var lookPrev = bind(prev(v1))(findUpWhere(v));
        return alt(lookPrev)(lookUp);
    };
};
var findUp = function (dictEq) {
    var eq = Data_Eq.eq(dictEq);
    return function (a) {
        return findUpWhere(function (v) {
            return eq(v)(a);
        });
    };
};
var root = function ($copy_l) {
    var $tco_done = false;
    var $tco_result;
    function $tco_loop(l) {
        var v = up(l);
        if (v instanceof Data_Maybe.Nothing) {
            $tco_done = true;
            return l;
        };
        if (v instanceof Data_Maybe.Just) {
            $copy_l = v.value0;
            return;
        };
        throw new Error("Failed pattern match at Data.Tree.Zipper (line 90, column 3 - line 92, column 21): " + [ v.constructor.name ]);
    };
    while (!$tco_done) {
        $tco_result = $tco_loop($copy_l);
    };
    return $tco_result;
};
var findFromRootWhere = function (v) {
    return function (v1) {
        if (v(value(v1))) {
            return new Data_Maybe.Just(v1);
        };
        return findDownWhere(v)(root(v1));
    };
};
var findFromRoot = function (dictEq) {
    var eq = Data_Eq.eq(dictEq);
    return function (a) {
        return findFromRootWhere(function (v) {
            return eq(v)(a);
        });
    };
};
var toTree = function ($131) {
    return node(root($131));
};
var siblingAt = function (i) {
    return function (v) {
        return bind(up(v))(function (p) {
            return bind(Data_List.index(children(p))(i))(function (c) {
                var before$prime = Data_List.reverse(Data_List.take(i)(children(p)));
                var after$prime = Data_List.drop(i + 1 | 0)(children(p));
                return pure({
                    node: c,
                    before: before$prime,
                    after: after$prime,
                    parents: v.parents
                });
            });
        });
    };
};
var childAt = function (i) {
    return function (p) {
        return bind(firstChild(p))(siblingAt(i));
    };
};
export {
    Loc,
    next,
    prev,
    first,
    last,
    up,
    root,
    firstChild,
    down,
    lastChild,
    siblingAt,
    childAt,
    toTree,
    fromTree,
    setNode,
    modifyNode,
    setValue,
    modifyValue,
    insertAfter,
    insertBefore,
    insertChild,
    $$delete as delete,
    findDownWhere,
    findDown,
    findUpWhere,
    findUp,
    findFromRootWhere,
    findFromRoot,
    flattenLocDepthFirst,
    node,
    value,
    before,
    after,
    parents,
    children,
    siblings,
    eqLoc
};
//# sourceMappingURL=index.js.map
