// Generated by purs version 0.15.15
import * as Data_Number from "../Data.Number/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Symbol from "../Data.Symbol/index.js";
import * as PSD3_Expr_Interpreter_Eval from "../PSD3.Expr.Interpreter.Eval/index.js";
import * as PSD3_Internal_Attribute from "../PSD3.Internal.Attribute/index.js";
import * as Type_Proxy from "../Type.Proxy/index.js";
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showBoolean);
var show1 = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var MetaD = function (x) {
    return x;
};
var EvalWithMeta = function (x) {
    return x;
};
var datumExprMetaD = function (dictIsSymbol) {
    var reflectSymbol = Data_Symbol.reflectSymbol(dictIsSymbol);
    return function () {
        return {
            field: function (dictIsSymbol1) {
                return function () {
                    return function (v) {
                        return new PSD3_Internal_Attribute.FieldSource(reflectSymbol(Type_Proxy["Proxy"].value));
                    };
                };
            },
            index: PSD3_Internal_Attribute.IndexSource.value
        };
    };
};
var datumExprEvalWithMetaReco = function (dictIsSymbol) {
    var reflectSymbol = Data_Symbol.reflectSymbol(dictIsSymbol);
    return function () {
        return {
            field: function (dictIsSymbol1) {
                return function () {
                    return function (v) {
                        return {
                            "eval": function (d) {
                                return function (v1) {
                                    return PSD3_Expr_Interpreter_Eval.unsafeGetField(reflectSymbol(Type_Proxy["Proxy"].value))(d);
                                };
                            },
                            meta: new PSD3_Internal_Attribute.FieldSource(reflectSymbol(Type_Proxy["Proxy"].value))
                        };
                    };
                };
            },
            index: {
                "eval": function (v) {
                    return function (i) {
                        return i;
                    };
                },
                meta: PSD3_Internal_Attribute.IndexSource.value
            }
        };
    };
};
var showSource = function (v) {
    if (v instanceof PSD3_Internal_Attribute.UnknownSource) {
        return "<unknown>";
    };
    if (v instanceof PSD3_Internal_Attribute.StaticSource) {
        return v.value0;
    };
    if (v instanceof PSD3_Internal_Attribute.FieldSource) {
        return "d." + v.value0;
    };
    if (v instanceof PSD3_Internal_Attribute.ExprSource) {
        return v.value0;
    };
    if (v instanceof PSD3_Internal_Attribute.IndexSource) {
        return "i";
    };
    if (v instanceof PSD3_Internal_Attribute.OpaqueSource) {
        return "<OPAQUE>";
    };
    throw new Error("Failed pattern match at PSD3.Expr.Interpreter.Meta (line 106, column 14 - line 112, column 29): " + [ v.constructor.name ]);
};
var runMetaD = function (v) {
    return v;
};
var runEvalWithMeta = function (v) {
    return v;
};
var prefixExpr = function (prefix) {
    return function (src) {
        return new PSD3_Internal_Attribute.ExprSource(prefix + showSource(src));
    };
};
var trigExprEvalWithMeta = /* #__PURE__ */ (function () {
    return {
        sin: function (v) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return Data_Number.sin(v["eval"](d)(i));
                    };
                },
                meta: prefixExpr("sin ")(v.meta)
            };
        },
        cos: function (v) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return Data_Number.cos(v["eval"](d)(i));
                    };
                },
                meta: prefixExpr("cos ")(v.meta)
            };
        },
        tan: function (v) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return Data_Number.tan(v["eval"](d)(i));
                    };
                },
                meta: prefixExpr("tan ")(v.meta)
            };
        },
        asin: function (v) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return Data_Number.asin(v["eval"](d)(i));
                    };
                },
                meta: prefixExpr("asin ")(v.meta)
            };
        },
        acos: function (v) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return Data_Number.acos(v["eval"](d)(i));
                    };
                },
                meta: prefixExpr("acos ")(v.meta)
            };
        },
        atan: function (v) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return Data_Number.atan(v["eval"](d)(i));
                    };
                },
                meta: prefixExpr("atan ")(v.meta)
            };
        },
        atan2: function (v) {
            return function (v1) {
                return {
                    "eval": function (d) {
                        return function (i) {
                            return Data_Number.atan2(v["eval"](d)(i))(v1["eval"](d)(i));
                        };
                    },
                    meta: new PSD3_Internal_Attribute.ExprSource("atan2 " + (showSource(v.meta) + (" " + showSource(v1.meta))))
                };
            };
        },
        pi: {
            "eval": function (v) {
                return function (v1) {
                    return Data_Number.pi;
                };
            },
            meta: new PSD3_Internal_Attribute.StaticSource("pi")
        }
    };
})();
var trigExprMetaD = /* #__PURE__ */ (function () {
    return {
        sin: function (v) {
            return prefixExpr("sin ")(v);
        },
        cos: function (v) {
            return prefixExpr("cos ")(v);
        },
        tan: function (v) {
            return prefixExpr("tan ")(v);
        },
        asin: function (v) {
            return prefixExpr("asin ")(v);
        },
        acos: function (v) {
            return prefixExpr("acos ")(v);
        },
        atan: function (v) {
            return prefixExpr("atan ")(v);
        },
        atan2: function (v) {
            return function (v1) {
                return new PSD3_Internal_Attribute.ExprSource("atan2 " + (showSource(v) + (" " + showSource(v1))));
            };
        },
        pi: new PSD3_Internal_Attribute.StaticSource("pi")
    };
})();
var evalWithMeta = function (v) {
    return function (v1) {
        return {
            "eval": v,
            meta: v1
        };
    };
};
var combineExpr = function (a) {
    return function (op) {
        return function (b) {
            if (a instanceof PSD3_Internal_Attribute.FieldSource && b instanceof PSD3_Internal_Attribute.FieldSource) {
                return new PSD3_Internal_Attribute.ExprSource("d." + (a.value0 + (op + ("d." + b.value0))));
            };
            if (a instanceof PSD3_Internal_Attribute.FieldSource && b instanceof PSD3_Internal_Attribute.StaticSource) {
                return new PSD3_Internal_Attribute.ExprSource("d." + (a.value0 + (op + b.value0)));
            };
            if (a instanceof PSD3_Internal_Attribute.StaticSource && b instanceof PSD3_Internal_Attribute.FieldSource) {
                return new PSD3_Internal_Attribute.ExprSource(a.value0 + (op + ("d." + b.value0)));
            };
            if (a instanceof PSD3_Internal_Attribute.StaticSource && b instanceof PSD3_Internal_Attribute.StaticSource) {
                return new PSD3_Internal_Attribute.ExprSource(a.value0 + (op + b.value0));
            };
            return new PSD3_Internal_Attribute.ExprSource(showSource(a) + (op + showSource(b)));
        };
    };
};
var boolExprEvalWithMeta = {
    bool: function (b) {
        return {
            "eval": function (v) {
                return function (v1) {
                    return b;
                };
            },
            meta: new PSD3_Internal_Attribute.StaticSource(show(b))
        };
    },
    and: function (v) {
        return function (v1) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return v["eval"](d)(i) && v1["eval"](d)(i);
                    };
                },
                meta: combineExpr(v.meta)(" && ")(v1.meta)
            };
        };
    },
    or: function (v) {
        return function (v1) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return v["eval"](d)(i) || v1["eval"](d)(i);
                    };
                },
                meta: combineExpr(v.meta)(" || ")(v1.meta)
            };
        };
    },
    not: function (v) {
        return {
            "eval": function (d) {
                return function (i) {
                    return !v["eval"](d)(i);
                };
            },
            meta: prefixExpr("not ")(v.meta)
        };
    },
    ifThenElse: function (v) {
        return function (v1) {
            return function (v2) {
                return {
                    "eval": function (d) {
                        return function (i) {
                            var $179 = v["eval"](d)(i);
                            if ($179) {
                                return v1["eval"](d)(i);
                            };
                            return v2["eval"](d)(i);
                        };
                    },
                    meta: new PSD3_Internal_Attribute.ExprSource("if " + (showSource(v.meta) + (" then " + (showSource(v1.meta) + (" else " + showSource(v2.meta))))))
                };
            };
        };
    }
};
var boolExprMetaD = {
    bool: function (b) {
        return new PSD3_Internal_Attribute.StaticSource(show(b));
    },
    and: function (v) {
        return function (v1) {
            return combineExpr(v)(" && ")(v1);
        };
    },
    or: function (v) {
        return function (v1) {
            return combineExpr(v)(" || ")(v1);
        };
    },
    not: function (v) {
        return prefixExpr("not ")(v);
    },
    ifThenElse: function (v) {
        return function (v1) {
            return function (v2) {
                return new PSD3_Internal_Attribute.ExprSource("if " + (showSource(v) + (" then " + (showSource(v1) + (" else " + showSource(v2))))));
            };
        };
    }
};
var compareExprEvalWithMeta = {
    lt: function (v) {
        return function (v1) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return v["eval"](d)(i) < v1["eval"](d)(i);
                    };
                },
                meta: combineExpr(v.meta)(" < ")(v1.meta)
            };
        };
    },
    lte: function (v) {
        return function (v1) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return v["eval"](d)(i) <= v1["eval"](d)(i);
                    };
                },
                meta: combineExpr(v.meta)(" <= ")(v1.meta)
            };
        };
    },
    gt: function (v) {
        return function (v1) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return v["eval"](d)(i) > v1["eval"](d)(i);
                    };
                },
                meta: combineExpr(v.meta)(" > ")(v1.meta)
            };
        };
    },
    gte: function (v) {
        return function (v1) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return v["eval"](d)(i) >= v1["eval"](d)(i);
                    };
                },
                meta: combineExpr(v.meta)(" >= ")(v1.meta)
            };
        };
    },
    eq: function (v) {
        return function (v1) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return v["eval"](d)(i) === v1["eval"](d)(i);
                    };
                },
                meta: combineExpr(v.meta)(" == ")(v1.meta)
            };
        };
    }
};
var compareExprMetaD = {
    lt: function (v) {
        return function (v1) {
            return combineExpr(v)(" < ")(v1);
        };
    },
    lte: function (v) {
        return function (v1) {
            return combineExpr(v)(" <= ")(v1);
        };
    },
    gt: function (v) {
        return function (v1) {
            return combineExpr(v)(" > ")(v1);
        };
    },
    gte: function (v) {
        return function (v1) {
            return combineExpr(v)(" >= ")(v1);
        };
    },
    eq: function (v) {
        return function (v1) {
            return combineExpr(v)(" == ")(v1);
        };
    }
};
var numExprEvalWithMeta = {
    lit: function (n) {
        return {
            "eval": function (v) {
                return function (v1) {
                    return n;
                };
            },
            meta: new PSD3_Internal_Attribute.StaticSource(show1(n))
        };
    },
    add: function (v) {
        return function (v1) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return v["eval"](d)(i) + v1["eval"](d)(i);
                    };
                },
                meta: combineExpr(v.meta)(" + ")(v1.meta)
            };
        };
    },
    sub: function (v) {
        return function (v1) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return v["eval"](d)(i) - v1["eval"](d)(i);
                    };
                },
                meta: combineExpr(v.meta)(" - ")(v1.meta)
            };
        };
    },
    mul: function (v) {
        return function (v1) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return v["eval"](d)(i) * v1["eval"](d)(i);
                    };
                },
                meta: combineExpr(v.meta)(" * ")(v1.meta)
            };
        };
    },
    div: function (v) {
        return function (v1) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return v["eval"](d)(i) / v1["eval"](d)(i);
                    };
                },
                meta: combineExpr(v.meta)(" / ")(v1.meta)
            };
        };
    },
    negate: function (v) {
        return {
            "eval": function (d) {
                return function (i) {
                    return -v["eval"](d)(i);
                };
            },
            meta: prefixExpr("-")(v.meta)
        };
    }
};
var numExprMetaD = {
    lit: function (n) {
        return new PSD3_Internal_Attribute.StaticSource(show1(n));
    },
    add: function (v) {
        return function (v1) {
            return combineExpr(v)(" + ")(v1);
        };
    },
    sub: function (v) {
        return function (v1) {
            return combineExpr(v)(" - ")(v1);
        };
    },
    mul: function (v) {
        return function (v1) {
            return combineExpr(v)(" * ")(v1);
        };
    },
    div: function (v) {
        return function (v1) {
            return combineExpr(v)(" / ")(v1);
        };
    },
    negate: function (v) {
        return prefixExpr("-")(v);
    }
};
var stringCompareExprEvalWith = {
    strEq: function (v) {
        return function (v1) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return v["eval"](d)(i) === v1["eval"](d)(i);
                    };
                },
                meta: combineExpr(v.meta)(" == ")(v1.meta)
            };
        };
    },
    strNeq: function (v) {
        return function (v1) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return v["eval"](d)(i) !== v1["eval"](d)(i);
                    };
                },
                meta: combineExpr(v.meta)(" /= ")(v1.meta)
            };
        };
    }
};
var stringCompareExprMetaD = {
    strEq: function (v) {
        return function (v1) {
            return combineExpr(v)(" == ")(v1);
        };
    },
    strNeq: function (v) {
        return function (v1) {
            return combineExpr(v)(" /= ")(v1);
        };
    }
};
var stringExprEvalWithMeta = {
    str: function (s) {
        return {
            "eval": function (v) {
                return function (v1) {
                    return s;
                };
            },
            meta: new PSD3_Internal_Attribute.StaticSource("\"" + (s + "\""))
        };
    },
    concat: function (v) {
        return function (v1) {
            return {
                "eval": function (d) {
                    return function (i) {
                        return v["eval"](d)(i) + v1["eval"](d)(i);
                    };
                },
                meta: combineExpr(v.meta)(" <> ")(v1.meta)
            };
        };
    }
};
var stringExprMetaD = {
    str: function (s) {
        return new PSD3_Internal_Attribute.StaticSource("\"" + (s + "\""));
    },
    concat: function (v) {
        return function (v1) {
            return combineExpr(v)(" <> ")(v1);
        };
    }
};
export {
    MetaD,
    runMetaD,
    EvalWithMeta,
    runEvalWithMeta,
    evalWithMeta,
    numExprMetaD,
    stringExprMetaD,
    boolExprMetaD,
    compareExprMetaD,
    stringCompareExprMetaD,
    trigExprMetaD,
    datumExprMetaD,
    numExprEvalWithMeta,
    stringExprEvalWithMeta,
    boolExprEvalWithMeta,
    trigExprEvalWithMeta,
    compareExprEvalWithMeta,
    stringCompareExprEvalWith,
    datumExprEvalWithMetaReco
};
//# sourceMappingURL=index.js.map
