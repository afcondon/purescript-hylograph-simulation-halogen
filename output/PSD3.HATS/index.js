// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as PSD3_Internal_Selection_Types from "../PSD3.Internal.Selection.Types/index.js";
var $runtime_lazy = function (name, moduleName, init) {
    var state = 0;
    var val;
    return function (lineNumber) {
        if (state === 2) return val;
        if (state === 1) throw new ReferenceError(name + " was needed before it finished initializing (module " + moduleName + ", line " + lineNumber + ")", moduleName, lineNumber);
        state = 1;
        val = init();
        state = 2;
        return val;
    };
};
var eq = /* #__PURE__ */ Data_Eq.eq(PSD3_Internal_Selection_Types.eqElementType);
var DepthFirst = /* #__PURE__ */ (function () {
    function DepthFirst() {

    };
    DepthFirst.value = new DepthFirst();
    return DepthFirst;
})();
var BreadthFirst = /* #__PURE__ */ (function () {
    function BreadthFirst() {

    };
    BreadthFirst.value = new BreadthFirst();
    return BreadthFirst;
})();
var FromArray = /* #__PURE__ */ (function () {
    function FromArray(value0) {
        this.value0 = value0;
    };
    FromArray.create = function (value0) {
        return new FromArray(value0);
    };
    return FromArray;
})();
var FromTree = /* #__PURE__ */ (function () {
    function FromTree(value0) {
        this.value0 = value0;
    };
    FromTree.create = function (value0) {
        return new FromTree(value0);
    };
    return FromTree;
})();
var WithContext = /* #__PURE__ */ (function () {
    function WithContext(value0) {
        this.value0 = value0;
    };
    WithContext.create = function (value0) {
        return new WithContext(value0);
    };
    return WithContext;
})();
var Siblings = /* #__PURE__ */ (function () {
    function Siblings() {

    };
    Siblings.value = new Siblings();
    return Siblings;
})();
var Nested = /* #__PURE__ */ (function () {
    function Nested() {

    };
    Nested.value = new Nested();
    return Nested;
})();
var Elem = /* #__PURE__ */ (function () {
    function Elem(value0) {
        this.value0 = value0;
    };
    Elem.create = function (value0) {
        return new Elem(value0);
    };
    return Elem;
})();
var Fold = /* #__PURE__ */ (function () {
    function Fold(value0) {
        this.value0 = value0;
    };
    Fold.create = function (value0) {
        return new Fold(value0);
    };
    return Fold;
})();
var Empty = /* #__PURE__ */ (function () {
    function Empty() {

    };
    Empty.value = new Empty();
    return Empty;
})();
var siblings = function (trees) {
    var $lazy_flatten = $runtime_lazy("flatten", "PSD3.HATS", function () {
        return Data_Array.concatMap(function (t) {
            if (t instanceof Empty) {
                return [  ];
            };
            var v = function (v1) {
                return [ t ];
            };
            if (t instanceof Elem) {
                var $10 = eq(t.value0.elemType)(PSD3_Internal_Selection_Types.Group.value);
                if ($10) {
                    var $11 = Data_Array["null"](t.value0.attrs);
                    if ($11) {
                        var $12 = Data_Array["null"](t.value0.behaviors);
                        if ($12) {
                            return $lazy_flatten(242)(t.value0.children);
                        };
                        return v(true);
                    };
                    return v(true);
                };
                return v(true);
            };
            return v(true);
        });
    });
    var flatten = $lazy_flatten(235);
    var v = flatten(trees);
    if (v.length === 0) {
        return Empty.value;
    };
    if (v.length === 1) {
        return v[0];
    };
    return new Elem({
        elemType: PSD3_Internal_Selection_Types.Group.value,
        attrs: [  ],
        children: v,
        behaviors: [  ]
    });
};
var semigroupTree = {
    append: function (v) {
        return function (v1) {
            if (v instanceof Empty) {
                return v1;
            };
            if (v1 instanceof Empty) {
                return v;
            };
            return siblings([ v, v1 ]);
        };
    }
};
var monoidTree = /* #__PURE__ */ (function () {
    return {
        mempty: Empty.value,
        Semigroup0: function () {
            return semigroupTree;
        }
    };
})();
var preserveTree = function (name) {
    return function (root) {
        return function (children) {
            return function (keyFn) {
                return function (template) {
                    return new Fold({
                        name: name,
                        enumerate: new FromTree({
                            root: root,
                            children: children,
                            order: DepthFirst.value,
                            includeInternal: true
                        }),
                        assemble: Nested.value,
                        keyFn: keyFn,
                        template: template,
                        gup: Data_Maybe.Nothing.value
                    });
                };
            };
        };
    };
};
var fromTree = function (name) {
    return function (root) {
        return function (children) {
            return function (keyFn) {
                return function (order) {
                    return function (includeInternal) {
                        return function (template) {
                            return new Fold({
                                name: name,
                                enumerate: new FromTree({
                                    root: root,
                                    children: children,
                                    order: order,
                                    includeInternal: includeInternal
                                }),
                                assemble: Siblings.value,
                                keyFn: keyFn,
                                template: template,
                                gup: Data_Maybe.Nothing.value
                            });
                        };
                    };
                };
            };
        };
    };
};
var forEachWithGUP = function (name) {
    return function (items) {
        return function (keyFn) {
            return function (template) {
                return function (gupSpec) {
                    return new Fold({
                        name: name,
                        enumerate: new FromArray(items),
                        assemble: Siblings.value,
                        keyFn: keyFn,
                        template: template,
                        gup: new Data_Maybe.Just(gupSpec)
                    });
                };
            };
        };
    };
};
var forEach = function (name) {
    return function (items) {
        return function (keyFn) {
            return function (template) {
                return new Fold({
                    name: name,
                    enumerate: new FromArray(items),
                    assemble: Siblings.value,
                    keyFn: keyFn,
                    template: template,
                    gup: Data_Maybe.Nothing.value
                });
            };
        };
    };
};
var fold = function (spec) {
    return new Fold({
        name: spec.name,
        enumerate: spec.enumerate,
        assemble: spec.assemble,
        keyFn: spec.keyFn,
        template: spec.template,
        gup: Data_Maybe.Nothing.value
    });
};
var empty = /* #__PURE__ */ (function () {
    return Empty.value;
})();
var elem = function (elemType) {
    return function (attrs) {
        return function (children) {
            return new Elem({
                elemType: elemType,
                attrs: attrs,
                children: children,
                behaviors: [  ]
            });
        };
    };
};
export {
    Elem,
    Fold,
    Empty,
    FromArray,
    FromTree,
    WithContext,
    Siblings,
    Nested,
    DepthFirst,
    BreadthFirst,
    elem,
    fold,
    empty,
    siblings,
    forEach,
    forEachWithGUP,
    fromTree,
    preserveTree,
    semigroupTree,
    monoidTree
};
//# sourceMappingURL=index.js.map
