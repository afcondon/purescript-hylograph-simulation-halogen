// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Function from "../Data.Function/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Semigroup from "../Data.Semigroup/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as PSD3_AST from "../PSD3.AST/index.js";
import * as PSD3_Internal_Attribute from "../PSD3.Internal.Attribute/index.js";
import * as PSD3_Internal_Selection_Types from "../PSD3.Internal.Selection.Types/index.js";
import * as PSD3_TreeDSL from "../PSD3.TreeDSL/index.js";
var append1 = /* #__PURE__ */ Data_Semigroup.append(Data_Semigroup.semigroupArray);
var withChildren = /* #__PURE__ */ PSD3_TreeDSL.withChildren(PSD3_AST.treeDSLTree);
var elem = /* #__PURE__ */ PSD3_TreeDSL.elem(PSD3_AST.treeDSLTree);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var show1 = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var conditionalRender = /* #__PURE__ */ PSD3_TreeDSL.conditionalRender(PSD3_AST.treeDSLTree);
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var CircleSpec = /* #__PURE__ */ (function () {
    function CircleSpec(value0) {
        this.value0 = value0;
    };
    CircleSpec.create = function (value0) {
        return new CircleSpec(value0);
    };
    return CircleSpec;
})();
var RectSpec = /* #__PURE__ */ (function () {
    function RectSpec(value0) {
        this.value0 = value0;
    };
    RectSpec.create = function (value0) {
        return new RectSpec(value0);
    };
    return RectSpec;
})();
var PolygonSpec = /* #__PURE__ */ (function () {
    function PolygonSpec(value0) {
        this.value0 = value0;
    };
    PolygonSpec.create = function (value0) {
        return new PolygonSpec(value0);
    };
    return PolygonSpec;
})();
var TableSpec = /* #__PURE__ */ (function () {
    function TableSpec(value0) {
        this.value0 = value0;
    };
    TableSpec.create = function (value0) {
        return new TableSpec(value0);
    };
    return TableSpec;
})();
var GroupSpec = /* #__PURE__ */ (function () {
    function GroupSpec(value0) {
        this.value0 = value0;
    };
    GroupSpec.create = function (value0) {
        return new GroupSpec(value0);
    };
    return GroupSpec;
})();
var tableSpec = function (v) {
    return new TableSpec({
        rows: v.rows,
        headerFill: Data_Function["const"]("#4d8bf5"),
        cellFill: Data_Function["const"]("#ffffff"),
        textColor: Data_Function["const"]("#111111"),
        cellPadding: Data_Function["const"](4.0)
    });
};
var rectSpec = function (v) {
    return new RectSpec({
        width: v.width,
        height: v.height,
        fill: v.fill,
        stroke: Data_Function["const"](Data_Maybe.Nothing.value),
        strokeWidth: Data_Function["const"](Data_Maybe.Nothing.value),
        cornerRadius: Data_Function["const"](Data_Maybe.Nothing.value)
    });
};
var polygonSpec = function (v) {
    return new PolygonSpec({
        points: v.points,
        fill: v.fill,
        stroke: Data_Function["const"](Data_Maybe.Nothing.value),
        strokeWidth: Data_Function["const"](Data_Maybe.Nothing.value)
    });
};
var maybeDataAttr = function (name) {
    return function (toVal) {
        return function (getMaybe) {
            return [ new PSD3_Internal_Attribute.DataAttr(name, PSD3_Internal_Attribute.UnknownSource.value, function (d) {
                var v = getMaybe(d);
                if (v instanceof Data_Maybe.Just) {
                    return toVal(v.value0);
                };
                if (v instanceof Data_Maybe.Nothing) {
                    return new PSD3_Internal_Attribute.StringValue("");
                };
                throw new Error("Failed pattern match at PSD3.TreeDSL.ShapeTree (line 345, column 7 - line 347, column 34): " + [ v.constructor.name ]);
            }) ];
        };
    };
};
var isTableSpec = function (v) {
    if (v instanceof TableSpec) {
        return true;
    };
    return false;
};
var isRectSpec = function (v) {
    if (v instanceof RectSpec) {
        return true;
    };
    return false;
};
var isPolygonSpec = function (v) {
    if (v instanceof PolygonSpec) {
        return true;
    };
    return false;
};
var isGroupSpec = function (v) {
    if (v instanceof GroupSpec) {
        return true;
    };
    return false;
};
var isCircleSpec = function (v) {
    if (v instanceof CircleSpec) {
        return true;
    };
    return false;
};
var groupSpec = function (children) {
    return new GroupSpec({
        children: children
    });
};
var fromShapeSpec = function (dict) {
    return dict.fromShapeSpec;
};
var dataAttr = function (name) {
    return function (f) {
        return new PSD3_Internal_Attribute.DataAttr(name, PSD3_Internal_Attribute.UnknownSource.value, f);
    };
};
var pathAttrs = function (spec) {
    var pointsToPath = function (pts) {
        return "M " + (pts + " Z");
    };
    return append1([ dataAttr("d")(function ($74) {
        return PSD3_Internal_Attribute.StringValue.create(pointsToPath(spec.points($74)));
    }), dataAttr("fill")(function ($75) {
        return PSD3_Internal_Attribute.StringValue.create(spec.fill($75));
    }) ])(append1(maybeDataAttr("stroke")(PSD3_Internal_Attribute.StringValue.create)(spec.stroke))(maybeDataAttr("stroke-width")(PSD3_Internal_Attribute.NumberValue.create)(spec.strokeWidth)));
};
var rectAttrs = function (spec) {
    return append1([ dataAttr("x")(function (d) {
        return new PSD3_Internal_Attribute.NumberValue(-spec.width(d) / 2.0);
    }), dataAttr("y")(function (d) {
        return new PSD3_Internal_Attribute.NumberValue(-spec.height(d) / 2.0);
    }), dataAttr("width")(function ($76) {
        return PSD3_Internal_Attribute.NumberValue.create(spec.width($76));
    }), dataAttr("height")(function ($77) {
        return PSD3_Internal_Attribute.NumberValue.create(spec.height($77));
    }), dataAttr("fill")(function ($78) {
        return PSD3_Internal_Attribute.StringValue.create(spec.fill($78));
    }) ])(append1(maybeDataAttr("stroke")(PSD3_Internal_Attribute.StringValue.create)(spec.stroke))(append1(maybeDataAttr("stroke-width")(PSD3_Internal_Attribute.NumberValue.create)(spec.strokeWidth))(maybeDataAttr("rx")(PSD3_Internal_Attribute.NumberValue.create)(spec.cornerRadius))));
};
var renderTable = function (spec) {
    return function (d) {
        var rows = spec.rows(d);
        var renderCell = function (cw) {
            return function (ch) {
                return function (yOff) {
                    return function (fill) {
                        return function (colIdx) {
                            return function (cellText) {
                                var xOffset = Data_Int.toNumber(colIdx) * cw;
                                return withChildren(elem(PSD3_Internal_Selection_Types.Group.value)([ dataAttr("transform")(Data_Function["const"](new PSD3_Internal_Attribute.StringValue("translate(" + (show(xOffset) + ("," + (show(yOff) + ")")))))) ]))([ elem(PSD3_Internal_Selection_Types.Rect.value)([ dataAttr("width")(Data_Function["const"](new PSD3_Internal_Attribute.NumberValue(cw))), dataAttr("height")(Data_Function["const"](new PSD3_Internal_Attribute.NumberValue(ch))), dataAttr("fill")(Data_Function["const"](new PSD3_Internal_Attribute.StringValue(fill))), dataAttr("stroke")(Data_Function["const"](new PSD3_Internal_Attribute.StringValue("#111"))), dataAttr("stroke-width")(Data_Function["const"](new PSD3_Internal_Attribute.NumberValue(0.5))) ]), elem(PSD3_Internal_Selection_Types.Text.value)([ dataAttr("x")(Data_Function["const"](new PSD3_Internal_Attribute.NumberValue(cw / 2.0))), dataAttr("y")(Data_Function["const"](new PSD3_Internal_Attribute.NumberValue(ch / 2.0 + 4.0))), dataAttr("text-anchor")(Data_Function["const"](new PSD3_Internal_Attribute.StringValue("middle"))), dataAttr("font-size")(Data_Function["const"](new PSD3_Internal_Attribute.StringValue("10px"))), dataAttr("font-family")(Data_Function["const"](new PSD3_Internal_Attribute.StringValue("Helvetica, sans-serif"))), dataAttr("fill")(Data_Function["const"](new PSD3_Internal_Attribute.StringValue(spec.textColor(d)))), dataAttr("textContent")(Data_Function["const"](new PSD3_Internal_Attribute.StringValue(cellText))) ]) ]);
                            };
                        };
                    };
                };
            };
        };
        var renderRow = function (cw) {
            return function (ch) {
                return function (rowIdx) {
                    return function (cells) {
                        var yOffset = Data_Int.toNumber(rowIdx) * ch;
                        var isHeader = rowIdx === 0;
                        var fill = (function () {
                            if (isHeader) {
                                return spec.headerFill(d);
                            };
                            return spec.cellFill(d);
                        })();
                        var cellGroups = Data_Array.mapWithIndex(renderCell(cw)(ch)(yOffset)(fill))(cells);
                        return withChildren(elem(PSD3_Internal_Selection_Types.Group.value)([ dataAttr("class")(Data_Function["const"](new PSD3_Internal_Attribute.StringValue("table-row row-" + show1(rowIdx)))) ]))(cellGroups);
                    };
                };
            };
        };
        var numRows = Data_Array.length(rows);
        var numCols = (function () {
            var v = Data_Array.head(rows);
            if (v instanceof Data_Maybe.Just) {
                return Data_Array.length(v.value0);
            };
            if (v instanceof Data_Maybe.Nothing) {
                return 1;
            };
            throw new Error("Failed pattern match at PSD3.TreeDSL.ShapeTree (line 370, column 15 - line 372, column 19): " + [ v.constructor.name ]);
        })();
        var totalWidth = Data_Int.toNumber(numCols) * 50.0;
        var rowGroups = Data_Array.mapWithIndex(renderRow(50.0)(20.0))(rows);
        var totalHeight = Data_Int.toNumber(numRows) * 20.0;
        return withChildren(elem(PSD3_Internal_Selection_Types.Group.value)([ dataAttr("class")(Data_Function["const"](new PSD3_Internal_Attribute.StringValue("table-shape"))), dataAttr("transform")(Data_Function["const"](new PSD3_Internal_Attribute.StringValue("translate(" + (show(-(totalWidth / 2.0)) + ("," + (show(-(totalHeight / 2.0)) + ")")))))) ]))(rowGroups);
    };
};
var circleSpec = function (v) {
    return new CircleSpec({
        radius: v.radius,
        fill: v.fill,
        stroke: Data_Function["const"](Data_Maybe.Nothing.value),
        strokeWidth: Data_Function["const"](Data_Maybe.Nothing.value)
    });
};
var circleAttrs = function (spec) {
    return append1([ dataAttr("r")(function ($79) {
        return PSD3_Internal_Attribute.NumberValue.create(spec.radius($79));
    }), dataAttr("fill")(function ($80) {
        return PSD3_Internal_Attribute.StringValue.create(spec.fill($80));
    }) ])(append1(maybeDataAttr("stroke")(PSD3_Internal_Attribute.StringValue.create)(spec.stroke))(maybeDataAttr("stroke-width")(PSD3_Internal_Attribute.NumberValue.create)(spec.strokeWidth)));
};
var shapeTreeDSLTree = {
    fromShapeSpec: function (getSpec) {
        return function (_dimensions) {
            return conditionalRender([ {
                predicate: function (d) {
                    return isCircleSpec(getSpec(d));
                },
                spec: function (d) {
                    var v = getSpec(d);
                    if (v instanceof CircleSpec) {
                        return elem(PSD3_Internal_Selection_Types.Circle.value)(circleAttrs(v.value0));
                    };
                    return elem(PSD3_Internal_Selection_Types.Group.value)([  ]);
                }
            }, {
                predicate: function (d) {
                    return isRectSpec(getSpec(d));
                },
                spec: function (d) {
                    var v = getSpec(d);
                    if (v instanceof RectSpec) {
                        return elem(PSD3_Internal_Selection_Types.Rect.value)(rectAttrs(v.value0));
                    };
                    return elem(PSD3_Internal_Selection_Types.Group.value)([  ]);
                }
            }, {
                predicate: function (d) {
                    return isPolygonSpec(getSpec(d));
                },
                spec: function (d) {
                    var v = getSpec(d);
                    if (v instanceof PolygonSpec) {
                        return elem(PSD3_Internal_Selection_Types.Path.value)(pathAttrs(v.value0));
                    };
                    return elem(PSD3_Internal_Selection_Types.Group.value)([  ]);
                }
            }, {
                predicate: function (d) {
                    return isTableSpec(getSpec(d));
                },
                spec: function (d) {
                    var v = getSpec(d);
                    if (v instanceof TableSpec) {
                        return renderTable(v.value0)(d);
                    };
                    return elem(PSD3_Internal_Selection_Types.Group.value)([  ]);
                }
            }, {
                predicate: function (d) {
                    return isGroupSpec(getSpec(d));
                },
                spec: function (d) {
                    var v = getSpec(d);
                    if (v instanceof GroupSpec) {
                        return withChildren(elem(PSD3_Internal_Selection_Types.Group.value)([  ]))(map(function (childSpec) {
                            return fromShapeSpec(shapeTreeDSLTree)(Data_Function["const"](childSpec))(_dimensions);
                        })(v.value0.children));
                    };
                    return elem(PSD3_Internal_Selection_Types.Group.value)([  ]);
                }
            } ]);
        };
    },
    TreeDSL0: function () {
        return PSD3_AST.treeDSLTree;
    }
};
export {
    fromShapeSpec,
    CircleSpec,
    RectSpec,
    PolygonSpec,
    TableSpec,
    GroupSpec,
    isCircleSpec,
    isRectSpec,
    isPolygonSpec,
    isTableSpec,
    isGroupSpec,
    circleSpec,
    rectSpec,
    polygonSpec,
    tableSpec,
    groupSpec,
    shapeTreeDSLTree
};
//# sourceMappingURL=index.js.map
