// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Number_Format from "../Data.Number.Format/index.js";
import * as DataViz_Layout_Sankey_Types from "../DataViz.Layout.Sankey.Types/index.js";
var eq = /* #__PURE__ */ Data_Eq.eq(DataViz_Layout_Sankey_Types.eqNodeID);
var findNode = function (nodes) {
    return function (nodeId) {
        return Data_Array.find(function (n) {
            return eq(n.index)(nodeId);
        })(nodes);
    };
};
var generateLinkPath = function (nodes) {
    return function (link) {
        var targetNode = findNode(nodes)(link.targetIndex);
        var sourceNode = findNode(nodes)(link.sourceIndex);
        if (sourceNode instanceof Data_Maybe.Just && targetNode instanceof Data_Maybe.Just) {
            var xi = (sourceNode.value0.x1 + targetNode.value0.x0) / 2.0;
            var y0Bottom = link.y0 + link.width / 2.0;
            var y0Top = link.y0 - link.width / 2.0;
            var y1Bottom = link.y1 + link.width / 2.0;
            var y1Top = link.y1 - link.width / 2.0;
            return "M" + (Data_Number_Format.toString(sourceNode.value0.x1) + ("," + (Data_Number_Format.toString(y0Top) + (" C" + (Data_Number_Format.toString(xi) + ("," + (Data_Number_Format.toString(y0Top) + (" " + (Data_Number_Format.toString(xi) + ("," + (Data_Number_Format.toString(y1Top) + (" " + (Data_Number_Format.toString(targetNode.value0.x0) + ("," + (Data_Number_Format.toString(y1Top) + (" L" + (Data_Number_Format.toString(targetNode.value0.x0) + ("," + (Data_Number_Format.toString(y1Bottom) + (" C" + (Data_Number_Format.toString(xi) + ("," + (Data_Number_Format.toString(y1Bottom) + (" " + (Data_Number_Format.toString(xi) + ("," + (Data_Number_Format.toString(y0Bottom) + (" " + (Data_Number_Format.toString(sourceNode.value0.x1) + ("," + (Data_Number_Format.toString(y0Bottom) + " Z")))))))))))))))))))))))))))))));
        };
        return "";
    };
};
var generateStraightPath = function (nodes) {
    return function (link) {
        var targetNode = findNode(nodes)(link.targetIndex);
        var sourceNode = findNode(nodes)(link.sourceIndex);
        if (sourceNode instanceof Data_Maybe.Just && targetNode instanceof Data_Maybe.Just) {
            return "M" + (Data_Number_Format.toString(sourceNode.value0.x1) + ("," + (Data_Number_Format.toString(link.y0) + (" L" + (Data_Number_Format.toString(targetNode.value0.x0) + ("," + Data_Number_Format.toString(link.y1)))))));
        };
        return "";
    };
};
export {
    findNode,
    generateLinkPath,
    generateStraightPath
};
//# sourceMappingURL=index.js.map
