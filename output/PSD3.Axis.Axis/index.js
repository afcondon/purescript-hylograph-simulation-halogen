// Generated by purs version 0.15.15
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Number_Format from "../Data.Number.Format/index.js";
import * as Data_Semigroup from "../Data.Semigroup/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as PSD3_AST from "../PSD3.AST/index.js";
import * as PSD3_Expr_Expr from "../PSD3.Expr.Expr/index.js";
import * as PSD3_Expr_Integration from "../PSD3.Expr.Integration/index.js";
import * as PSD3_Expr_Interpreter_Eval from "../PSD3.Expr.Interpreter.Eval/index.js";
import * as PSD3_Internal_Selection_Types from "../PSD3.Internal.Selection.Types/index.js";
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var str = /* #__PURE__ */ PSD3_Expr_Expr.str(PSD3_Expr_Interpreter_Eval.stringExprEvalD);
var evalAttr = /* #__PURE__ */ PSD3_Expr_Integration.evalAttr(Data_Show.showNumber);
var lit = /* #__PURE__ */ PSD3_Expr_Expr.lit(PSD3_Expr_Interpreter_Eval.numExprEvalD);
var append1 = /* #__PURE__ */ Data_Semigroup.append(Data_Semigroup.semigroupArray);
var Top = /* #__PURE__ */ (function () {
    function Top() {

    };
    Top.value = new Top();
    return Top;
})();
var Right = /* #__PURE__ */ (function () {
    function Right() {

    };
    Right.value = new Right();
    return Right;
})();
var Bottom = /* #__PURE__ */ (function () {
    function Bottom() {

    };
    Bottom.value = new Bottom();
    return Bottom;
})();
var Left = /* #__PURE__ */ (function () {
    function Left() {

    };
    Left.value = new Left();
    return Left;
})();
var generateTicks = function (scale) {
    return function (count) {
        var step = (scale.domain.max - scale.domain.min) / Data_Int.toNumber(count);
        return map(function (i) {
            return scale.domain.min + Data_Int.toNumber(i) * step;
        })(Data_Array.range(0)(count));
    };
};
var eqOrientation = {
    eq: function (x) {
        return function (y) {
            if (x instanceof Top && y instanceof Top) {
                return true;
            };
            if (x instanceof Right && y instanceof Right) {
                return true;
            };
            if (x instanceof Bottom && y instanceof Bottom) {
                return true;
            };
            if (x instanceof Left && y instanceof Left) {
                return true;
            };
            return false;
        };
    }
};
var defaultTickFormat = function (n) {
    var $18 = n === 0.0;
    if ($18) {
        return "0";
    };
    return Data_Number_Format.toStringWith(Data_Number_Format.fixed(1))(n);
};
var defaultAxisConfig = /* #__PURE__ */ (function () {
    return {
        tickSize: 6.0,
        tickPadding: 3.0,
        tickCount: 10,
        tickFormat: Data_Maybe.Nothing.value
    };
})();
var axisTop = function (scale) {
    return {
        orientation: Top.value,
        scale: scale,
        config: defaultAxisConfig
    };
};
var axisRight = function (scale) {
    return {
        orientation: Right.value,
        scale: scale,
        config: defaultAxisConfig
    };
};
var axisLeft = function (scale) {
    return {
        orientation: Left.value,
        scale: scale,
        config: defaultAxisConfig
    };
};
var axisBottom = function (scale) {
    return {
        orientation: Bottom.value,
        scale: scale,
        config: defaultAxisConfig
    };
};
var axis = function (orientation) {
    return function (scale) {
        return {
            orientation: orientation,
            scale: scale,
            config: defaultAxisConfig
        };
    };
};
var applyScale = function (scale) {
    return function (value) {
        var rangeSpan = scale.range.max - scale.range.min;
        var domainSpan = scale.domain.max - scale.domain.min;
        var normalized = (value - scale.domain.min) / domainSpan;
        return scale.range.min + normalized * rangeSpan;
    };
};
var renderAxis = function (ax) {
    var ticks = generateTicks(ax.scale)(ax.config.tickCount);
    var formatter = Data_Maybe.fromMaybe(defaultTickFormat)(ax.config.tickFormat);
    var v = (function () {
        if (ax.orientation instanceof Bottom) {
            return {
                domainPath: "M" + (show(ax.scale.range.min) + (",0H" + show(ax.scale.range.max))),
                tickTransform: function (pos) {
                    return "translate(" + (show(pos) + ",0)");
                },
                tickLine: {
                    x1: 0.0,
                    y1: 0.0,
                    x2: 0.0,
                    y2: ax.config.tickSize
                },
                tickText: {
                    x: 0.0,
                    y: ax.config.tickSize + ax.config.tickPadding,
                    anchor: "middle",
                    dyVal: 7.0
                }
            };
        };
        if (ax.orientation instanceof Left) {
            return {
                domainPath: "M0," + (show(ax.scale.range.min) + ("V" + show(ax.scale.range.max))),
                tickTransform: function (pos) {
                    return "translate(0," + (show(pos) + ")");
                },
                tickLine: {
                    x1: -ax.config.tickSize,
                    y1: 0.0,
                    x2: 0.0,
                    y2: 0.0
                },
                tickText: {
                    x: -(ax.config.tickSize + ax.config.tickPadding),
                    y: 0.0,
                    anchor: "end",
                    dyVal: 3.0
                }
            };
        };
        if (ax.orientation instanceof Top) {
            return {
                domainPath: "M" + (show(ax.scale.range.min) + (",0H" + show(ax.scale.range.max))),
                tickTransform: function (pos) {
                    return "translate(" + (show(pos) + ",0)");
                },
                tickLine: {
                    x1: 0.0,
                    y1: -ax.config.tickSize,
                    x2: 0.0,
                    y2: 0.0
                },
                tickText: {
                    x: 0.0,
                    y: -(ax.config.tickSize + ax.config.tickPadding),
                    anchor: "middle",
                    dyVal: 0.0
                }
            };
        };
        if (ax.orientation instanceof Right) {
            return {
                domainPath: "M0," + (show(ax.scale.range.min) + ("V" + show(ax.scale.range.max))),
                tickTransform: function (pos) {
                    return "translate(0," + (show(pos) + ")");
                },
                tickLine: {
                    x1: 0.0,
                    y1: 0.0,
                    x2: ax.config.tickSize,
                    y2: 0.0
                },
                tickText: {
                    x: ax.config.tickSize + ax.config.tickPadding,
                    y: 0.0,
                    anchor: "start",
                    dyVal: 3.0
                }
            };
        };
        throw new Error("Failed pattern match at PSD3.Axis.Axis (line 120, column 57 - line 144, column 10): " + [ ax.orientation.constructor.name ]);
    })();
    var tickElements = map(function (tickValue) {
        var pos = applyScale(ax.scale)(tickValue);
        return PSD3_AST.withChildren(PSD3_AST.elem(PSD3_Internal_Selection_Types.Group.value)([ PSD3_Expr_Integration.evalAttrStr("class")(str("tick")), PSD3_Expr_Integration.evalAttrStr("transform")(str(v.tickTransform(pos))) ]))([ PSD3_AST.elem(PSD3_Internal_Selection_Types.Line.value)([ evalAttr("x1")(lit(v.tickLine.x1)), evalAttr("y1")(lit(v.tickLine.y1)), evalAttr("x2")(lit(v.tickLine.x2)), evalAttr("y2")(lit(v.tickLine.y2)), PSD3_Expr_Integration.evalAttrStr("stroke")(str("currentColor")) ]), PSD3_AST.elem(PSD3_Internal_Selection_Types.Text.value)([ evalAttr("x")(lit(v.tickText.x)), evalAttr("y")(lit(v.tickText.y)), PSD3_Expr_Integration.evalAttrStr("text-anchor")(str(v.tickText.anchor)), evalAttr("dy")(lit(v.tickText.dyVal)), PSD3_Expr_Integration.evalAttrStr("fill")(str("currentColor")), evalAttr("font-size")(lit(10.0)), PSD3_Expr_Integration.evalAttrStr("textContent")(str(formatter(tickValue))) ]) ]);
    })(ticks);
    return PSD3_AST.withChildren(PSD3_AST.elem(PSD3_Internal_Selection_Types.Group.value)([ PSD3_Expr_Integration.evalAttrStr("class")(str("axis")), PSD3_Expr_Integration.evalAttrStr("fill")(str("none")), evalAttr("font-size")(lit(10.0)), PSD3_Expr_Integration.evalAttrStr("stroke")(str("currentColor")) ]))(append1([ PSD3_AST.elem(PSD3_Internal_Selection_Types.Path.value)([ PSD3_Expr_Integration.evalAttrStr("class")(str("domain")), PSD3_Expr_Integration.evalAttrStr("stroke")(str("currentColor")), PSD3_Expr_Integration.evalAttrStr("d")(str(v.domainPath)) ]) ])(tickElements));
};
export {
    Top,
    Right,
    Bottom,
    Left,
    defaultAxisConfig,
    axisBottom,
    axisLeft,
    axisTop,
    axisRight,
    axis,
    renderAxis,
    eqOrientation
};
//# sourceMappingURL=index.js.map
