// Generated by purs version 0.15.15
import * as Control_Category from "../Control.Category/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Number from "../Data.Number/index.js";
import * as Data_Semiring from "../Data.Semiring/index.js";
var sum = /* #__PURE__ */ Data_Foldable.sum(Data_Foldable.foldableArray)(Data_Semiring.semiringNumber);
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var sortByValueDesc = function (dictOrd) {
    var $29 = Data_Array.sort(dictOrd);
    return function ($30) {
        return Data_Array.reverse($29($30));
    };
};
var sortByValue = function (dictOrd) {
    return Data_Array.sort(dictOrd);
};
var pieWithConfig = function (config) {
    return function (getValue) {
        return function (data_) {
            var sortedData = config.sort(data_);
            var indexedData = Data_Array.mapWithIndex(function (i) {
                return function (d) {
                    return {
                        index: i,
                        data: d,
                        value: getValue(d)
                    };
                };
            })(sortedData);
            var n = Data_Array.length(indexedData);
            var totalPadding = config.padAngle * (function () {
                var $20 = n > 1;
                if ($20) {
                    return Data_Int.toNumber(n - 1 | 0);
                };
                return 0.0;
            })();
            var total = sum(map(function (v) {
                return v.value;
            })(indexedData));
            var availableArc = config.endAngle - config.startAngle - totalPadding;
            var scale = (function () {
                var $21 = total > 0.0;
                if ($21) {
                    return availableArc / total;
                };
                return 0.0;
            })();
            var buildSlices = function (v) {
                return function (v1) {
                    if (Data_Array["null"](v1)) {
                        return [  ];
                    };
                    var v2 = Data_Array.uncons(v1);
                    if (v2 instanceof Data_Maybe.Nothing) {
                        return [  ];
                    };
                    if (v2 instanceof Data_Maybe.Just) {
                        var arcLength = v2.value0.head.value * scale;
                        var nextAngle = v + arcLength + (function () {
                            var $25 = Data_Array["null"](v2.value0.tail);
                            if ($25) {
                                return 0.0;
                            };
                            return config.padAngle;
                        })();
                        var slice = {
                            value: v2.value0.head.value,
                            startAngle: v,
                            endAngle: v + arcLength,
                            padAngle: config.padAngle,
                            index: v2.value0.head.index,
                            data: v2.value0.head.data
                        };
                        return Data_Array.cons(slice)(buildSlices(nextAngle)(v2.value0.tail));
                    };
                    throw new Error("Failed pattern match at PSD3.Shape.Pie (line 104, column 7 - line 119, column 58): " + [ v2.constructor.name ]);
                };
            };
            return buildSlices(config.startAngle)(indexedData);
        };
    };
};
var defaultPieConfig = /* #__PURE__ */ (function () {
    return {
        startAngle: 0.0,
        endAngle: 2.0 * Data_Number.pi,
        padAngle: 0.0,
        sort: Control_Category.identity(Control_Category.categoryFn)
    };
})();
var pie = /* #__PURE__ */ pieWithConfig(defaultPieConfig);
export {
    pie,
    pieWithConfig,
    defaultPieConfig,
    sortByValue,
    sortByValueDesc
};
//# sourceMappingURL=index.js.map
