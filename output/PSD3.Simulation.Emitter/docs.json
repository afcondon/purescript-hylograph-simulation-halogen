{"comments":"Framework-Agnostic Event Emitter\n\nProvides a universal subscription mechanism that any UI framework can consume.\nThe core simulation library emits events through this interface, and thin\nframework adapters convert it to Halogen subscriptions, React hooks, etc.\n\n## Design\n\nThe emitter is based on a simple callback pattern:\n- `subscribe` takes a callback and returns an unsubscribe function\n- This is the minimal interface that all frameworks can work with\n\n## Framework Integration\n\n**Halogen**: Convert to `HS.Emitter` using `toHalogenEmitter` from\n`PSD3.ForceEngine.Halogen`:\n\n```purescript\nimport PSD3.ForceEngine.Halogen (toHalogenEmitter)\n\nhandleAction Initialize = do\n  { handle, events } <- liftEffect $ runSimulation config\n  halogenEmitter <- liftEffect $ toHalogenEmitter events\n  void $ H.subscribe $ halogenEmitter <#> SimEvent\n```\n\n**React**: Use in `useEffect` with cleanup. The unsubscribe function\nreturned by `subscribe` works perfectly as a React cleanup function:\n\n```javascript\n// In a React component:\nuseEffect(() => {\n  const { handle, events } = runSimulation(config)();\n\n  // Subscribe returns an unsubscribe function\n  const unsubscribe = subscribe(events)(event => {\n    if (event.tag === 'Tick') {\n      setAlpha(event.alpha);\n    } else if (event.tag === 'Completed') {\n      console.log('Simulation converged!');\n    }\n  })();\n\n  // Cleanup: unsubscribe when component unmounts\n  return () => unsubscribe();\n}, []);\n```\n\n**Vanilla JS**: Just call subscribe directly:\n\n```javascript\nconst { handle, events } = runSimulation(config)();\nconst unsubscribe = subscribe(events)(event => {\n  console.log('Event:', event);\n})();\n```\n","declarations":[{"children":[],"comments":"Framework-agnostic event emitter\n\nThis is intentionally opaque - use `subscribe` to listen for events.\nThe internal representation is a list of listeners with unique IDs.\n","info":{"dataDeclType":"newtype","declType":"data","roles":[],"typeArguments":[]},"kind":null,"sourceSpan":{"end":[116,4],"name":"../purescript-psd3-simulation/src/PSD3/Simulation/Emitter.purs","start":[113,1]},"title":"SimulationEmitter"},{"children":[{"comments":null,"info":{"arguments":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Record"],"tag":"TypeConstructor"},{"annotation":[],"contents":["alpha",{"annotation":[],"contents":[["Prim"],"Number"],"tag":"TypeConstructor"},{"annotation":[],"contents":["nodeCount",{"annotation":[],"contents":[["Prim"],"Int"],"tag":"TypeConstructor"},{"annotation":[],"tag":"REmpty"}],"tag":"RCons"}],"tag":"RCons"}],"tag":"TypeApp"}],"declType":"dataConstructor"},"sourceSpan":{"end":[84,9],"name":"../purescript-psd3-simulation/src/PSD3/Simulation/Emitter.purs","start":[84,3]},"title":"Tick"},{"comments":null,"info":{"arguments":[],"declType":"dataConstructor"},"sourceSpan":{"end":[88,12],"name":"../purescript-psd3-simulation/src/PSD3/Simulation/Emitter.purs","start":[88,3]},"title":"Started"},{"comments":null,"info":{"arguments":[],"declType":"dataConstructor"},"sourceSpan":{"end":[89,12],"name":"../purescript-psd3-simulation/src/PSD3/Simulation/Emitter.purs","start":[89,3]},"title":"Stopped"},{"comments":null,"info":{"arguments":[],"declType":"dataConstructor"},"sourceSpan":{"end":[90,14],"name":"../purescript-psd3-simulation/src/PSD3/Simulation/Emitter.purs","start":[90,3]},"title":"Completed"},{"comments":null,"info":{"declType":"instance","dependencies":[],"type":{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Eq"],"Eq"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["PSD3","Simulation","Emitter"],"SimulationEvent"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"sourceSpan":{"end":[92,56],"name":"../purescript-psd3-simulation/src/PSD3/Simulation/Emitter.purs","start":[92,1]},"title":"eqSimulationEvent"},{"comments":null,"info":{"declType":"instance","dependencies":[],"type":{"annotation":[],"contents":[{"annotation":[],"contents":[["Data","Show"],"Show"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["PSD3","Simulation","Emitter"],"SimulationEvent"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"sourceSpan":{"end":[98,31],"name":"../purescript-psd3-simulation/src/PSD3/Simulation/Emitter.purs","start":[94,1]},"title":"showSimulationEvent"}],"comments":"Event types emitted by simulations\n\nThese are the same regardless of whether D3 or WASM is running the physics.\n","info":{"dataDeclType":"data","declType":"data","roles":[],"typeArguments":[]},"kind":null,"sourceSpan":{"end":[90,14],"name":"../purescript-psd3-simulation/src/PSD3/Simulation/Emitter.purs","start":[83,1]},"title":"SimulationEvent"},{"children":[],"comments":"Unsubscribe function returned by subscribe\n","info":{"arguments":[],"declType":"typeSynonym","type":{"annotation":[],"contents":[{"annotation":[],"contents":[["Effect"],"Effect"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Data","Unit"],"Unit"],"tag":"TypeConstructor"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[101,31],"name":"../purescript-psd3-simulation/src/PSD3/Simulation/Emitter.purs","start":[101,1]},"title":"Unsubscribe"},{"children":[],"comments":"Create a new emitter\n\nReturns both the emitter (for subscribers) and a handle (for the simulation\nto emit events). This separation ensures only the simulation can emit.\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[["Effect"],"Effect"],"tag":"TypeConstructor"},{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Record"],"tag":"TypeConstructor"},{"annotation":[],"contents":["emitter",{"annotation":[],"contents":[["PSD3","Simulation","Emitter"],"SimulationEmitter"],"tag":"TypeConstructor"},{"annotation":[],"contents":["handle",{"annotation":[],"contents":[["PSD3","Simulation","Emitter"],"EmitterHandle"],"tag":"TypeConstructor"},{"annotation":[],"tag":"REmpty"}],"tag":"RCons"}],"tag":"RCons"}],"tag":"TypeApp"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[127,75],"name":"../purescript-psd3-simulation/src/PSD3/Simulation/Emitter.purs","start":[127,1]},"title":"create"},{"children":[],"comments":"Handle for emitting events (kept by the simulation, not exposed to users)\n","info":{"dataDeclType":"newtype","declType":"data","roles":[],"typeArguments":[]},"kind":null,"sourceSpan":{"end":[121,4],"name":"../purescript-psd3-simulation/src/PSD3/Simulation/Emitter.purs","start":[119,1]},"title":"EmitterHandle"},{"children":[],"comments":"Subscribe to events\n\nReturns an unsubscribe function that removes the listener.\n\n```purescript\nunsubscribe <- subscribe emitter \\event -> case event of\n  Tick { alpha } -> log $ \"Alpha: \" <> show alpha\n  Completed -> log \"Simulation converged!\"\n  _ -> pure unit\n\n-- Later, to stop listening:\nunsubscribe\n```\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["PSD3","Simulation","Emitter"],"SimulationEmitter"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["PSD3","Simulation","Emitter"],"SimulationEvent"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[["Effect"],"Effect"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Data","Unit"],"Unit"],"tag":"TypeConstructor"}],"tag":"TypeApp"}],"tag":"TypeApp"},"tag":"ParensInType"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[["Effect"],"Effect"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["PSD3","Simulation","Emitter"],"Unsubscribe"],"tag":"TypeConstructor"}],"tag":"TypeApp"}],"tag":"TypeApp"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[147,89],"name":"../purescript-psd3-simulation/src/PSD3/Simulation/Emitter.purs","start":[147,1]},"title":"subscribe"},{"children":[],"comments":"Emit an event to all subscribers (internal use only)\n\nThis is called by the simulation implementation, not by users.\n","info":{"declType":"value","type":{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["PSD3","Simulation","Emitter"],"EmitterHandle"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[{"annotation":[],"contents":[["Prim"],"Function"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["PSD3","Simulation","Emitter"],"SimulationEvent"],"tag":"TypeConstructor"}],"tag":"TypeApp"},{"annotation":[],"contents":[{"annotation":[],"contents":[["Effect"],"Effect"],"tag":"TypeConstructor"},{"annotation":[],"contents":[["Data","Unit"],"Unit"],"tag":"TypeConstructor"}],"tag":"TypeApp"}],"tag":"TypeApp"}],"tag":"TypeApp"}},"kind":null,"sourceSpan":{"end":[163,56],"name":"../purescript-psd3-simulation/src/PSD3/Simulation/Emitter.purs","start":[163,1]},"title":"emit"}],"name":"PSD3.Simulation.Emitter","reExports":[]}